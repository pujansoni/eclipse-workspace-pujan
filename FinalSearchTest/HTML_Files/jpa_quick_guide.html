<!DOCTYPE html>
<!--[if IE 8]><html class="ie ie8"> <![endif]-->
<!--[if IE 9]><html class="ie ie9"> <![endif]-->
<!--[if gt IE 9]><!-->	<html> <!--<![endif]-->

<!-- Mirrored from www.tutorialspoint.com/jpa/jpa_quick_guide.htm by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 16 Aug 2017 15:18:12 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<!-- Basic -->
<meta charset="utf-8">
<title>JPA Quick Guide</title>
<meta name="description" content="JPA Quick Guide - Learn JPA in simple and easy steps using this beginner's tutorial containing basic to advanced knowledge starting from Introduction, Architecture, ORM Components, Installation, Entity Managers, JPQL, Advanced Mappings, Entity Relationships and Criteria API." />
<meta name="keywords" content="JPA, Tutorials, Learning, Beginners, Basics, Introduction, Architecture, ORM Components, Installation, Entity Managers, JPQL, Advanced Mappings, Entity Relationships, Criteria API." />
<base  />
<link rel="shortcut icon" href="../favicon.ico" type="image/x-icon" />
<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=yes">
<meta property="og:locale" content="en_US" />
<meta property="og:type" content="website" />
<meta property="fb:app_id" content="471319149685276" />
<meta property="og:site_name" content="www.tutorialspoint.com" />
<meta name="robots" content="index, follow"/>
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black">
<meta name="author" content="tutorialspoint.com">
<script type="text/javascript" src="../theme/js/script-min-v4.js"></script>
<link rel="stylesheet" href="../theme/css/style-min5e1f.css?v=2">
<!-- Head Libs -->
<!--[if IE 8]>
<link rel="stylesheet" type="text/css" href="/theme/css/ie8.css">
<![endif]-->
<style>
select{ border:0 !important; outline: 1px inset black !important; outline-offset: -1px !important; }
ul.nav-list.primary>li a.videolink{    background: none; margin: 0px; padding: 0px; border: 1px solid #d6d6d6;}
div.feature-box div.feature-box-icon, .col-md-3 .course-box, li.heading, div.footer-copyright { background: #03317e url(../images/pattern.png) repeat center center !important;}
.sub-main-menu .sub-menuu div:hover, .sub-main-menu .viewall, header nav ul.nav-main li a:hover, button.btn-responsive-nav, header div.search button.btn-default { background: #03317e !important;}
.submenu-item{ border-bottom: 2px solid #03317e !important; border-top: 2px solid #03317e !important }
.ace_scroller{overflow: auto!important;}
</style>
<script>
$(document).ready(function() {
  $('input[name="q"]').keydown(function(event){
    if(event.keyCode == 13) {
      event.preventDefault();
      return false;
    }
  });
});
</script>
</head>
<body onload="prettyPrint()">
<div class="wrapLoader">
   <div class="imgLoader">
      <img  src="../images/loading-cg.gif" alt="" width="70" height="70" />
   </div>
</div>
<header>
   <div class="container">			
      <h1 class="logo">
      <a href="../index-2.html" title="tutorialspoint">
      <img alt="tutorialspoint" src="images/logo.png">
      </a>
      </h1>			
      <nav>
         <ul class="nav nav-pills nav-top">
            <li><a href="../about/about_careers.html" style="background: #fffb09; font-weight: bold;"><i class="icon icon-suitcase"></i> Jobs</a></li>
            <li> <a href="http://www.sendfiles.net/"><i class="fa fa-send"></i> &nbsp;SENDFiles</a> </li>
            <li> <a href="../whiteboard.html"><img src="../theme/css/icons/image-editor.png" alt="Whiteboard" title="Whiteboard"> &nbsp;Whiteboard</a> </li>
            <li> <a href="../netmeeting.html"><i class="fa-camera"></i> &nbsp;Net Meeting</a> </li>
            <li> <a href="../online_dev_tools.html"> <i class="dev-tools-menu" style="opacity:.5"></i> Tools </a> </li>
            <li> <a href="../articles/index.html"><i class="icon icon-file-text-o"></i> &nbsp;Articles</a> </li>            
            <li class="top-icons">
              <ul class="social-icons">
              <li class="facebook"><a href="https://www.facebook.com/tutorialspointindia" target="_blank" data-placement="bottom" title="tutorialspoint @ Facebook">Facebook</a></li>
              <li class="googleplus"><a href="https://plus.google.com/u/0/116678774017490391259/posts" target="_blank" data-placement="bottom" title="tutorialspoint @ Google+">Google+</a></li>
              <li class="twitter"><a href="https://www.twitter.com/tutorialspoint" target="_blank" data-placement="bottom" title="tutorialspoint @ Twitter">Twitter</a></li>
              <li class="linkedin"><a href="https://www.linkedin.com/company/tutorialspoint" target="_blank" data-placement="bottom" title="tutorialspoint @ Linkedin">Linkedin</a></li>
              <li class="youtube"><a href="https://www.youtube.com/channel/UCVLbzhxVTiTLiVKeGV7WEBg" target="_blank" data-placement="bottom" title="tutorialspoint YouTube">YouTube</a></li>
              </ul>
           </li>
         </ul>
      </nav>
         <!-- search code here  --> 
      <button class="btn btn-responsive-nav btn-inverse" data-toggle="collapse" data-target=".nav-main-collapse" id="pull" style="top: 24px!important"> <i class="icon icon-bars"></i> </button>
   </div>
  
   <div class="navbar nav-main">
      <div class="container">
         <nav class="nav-main mega-menu">
            <ul class="nav nav-pills nav-main" id="mainMenu">
               <li class="dropdown no-sub-menu"> <a class="dropdown" href="../index-2.html"><i class="icon icon-home"></i> Home</a> </li>   
               <li class="dropdown" id="liTL"><a class="dropdown" href="javascript:void(0);"><span class="tut-lib"> Tutorials Library <i class="fa-caret-down"></i></span></a></li>
               <li class="dropdown no-sub-menu"><a class="dropdown" href="../codingground.html"><i class="fa-code"></i> Coding Ground </a> </li>
               <li class="dropdown no-sub-menu"><a class="dropdown" href="../tutor_connect/index.html"><i class="fa-user"> </i> Tutor Connect</a></li>
               <li class="dropdown no-sub-menu"><a class="dropdown" href="../videotutorials/index.html"><i class="fa-toggle-right"></i> Videos </a></li>
               <li class="dropdown no-sub-menu">
                  <div class="searchform-popup">
                     <input class="header-search-box" type="text" id="search-string" name="q" placeholder="Search your favorite tutorials..." onfocus="if (this.value == 'Search your favorite tutorials...') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Search your favorite tutorials...';}" autocomplete="off">
                     <div class="magnifying-glass"><i class="icon-search"></i> Search </div>
                 </div>
               </li>
            </ul>
         </nav>
         <div class="submenu-item sub-main-menu" id="top-sub-menu"></div>
         
      </div>
   </div>	
</header>
<div style="clear:both;"></div>
<div role="main" class="main">
<div class="container">
<div class="row">
<div class="col-md-2">
<aside class="sidebar">
<div class="mini-logo">
<img src="images/jpa-mini-logo.jpg" alt="JPA Tutorial" />
</div>
<ul class="nav nav-list primary left-menu" >
<li class="heading">JPA Tutorial</li>
<li><a target="_top" href="index.html">JPA - Home</a></li>
<li><a target="_top" href="jpa_introduction.html">JPA - Introduction</a></li>
<li><a target="_top" href="jpa_architecture.html">JPA - Architecture</a></li>
<li><a target="_top" href="jpa_orm_components.html">JPA -  ORM Components</a></li>
<li><a target="_top" href="jpa_installation.html">JPA - Installation</a></li>
<li><a target="_top" href="jpa_entity_managers.html">JPA - Entity Managers</a></li>
<li><a target="_top" href="jpa_jpql.html">JPA - JPQL</a></li>
<li><a target="_top" href="jpa_advanced_mappings.html">JPA - Advanced Mappings</a></li>
<li><a target="_top" href="jpa_entity_relationships.html">JPA - Entity Relationships</a></li>
<li><a target="_top" href="jpa_criteria_api.html">JPA - Criteria API</a></li>
</ul>
<ul class="nav nav-list primary left-menu" >
<li class="heading">JPA Useful Resources</li>
<li><a target="_top" href="jpa_quick_guide.html">JPA - Quick Guide</a></li>
<li><a target="_top" href="jpa_useful_resources.html">JPA - Useful Resources</a></li>
<li><a target="_top" href="jpa_discussion.html">JPA - Discussion</a></li>
</ul>
<ul class="nav nav-list primary push-bottom left-menu special">
<li class="sreading">Selected Reading</li>
<li><a target="_top" href="../developers_best_practices/index.html">Developer's Best Practices</a></li>
<li><a target="_top" href="../questions_and_answers.html">Questions and Answers</a></li>
<li><a target="_top" href="../effective_resume_writing.html">Effective Resume Writing</a></li>
<li><a target="_top" href="../hr_interview_questions/index.html">HR Interview Questions</a></li>
<li><a target="_top" href="../computer_glossary.html">Computer Glossary</a></li>
<li><a target="_top" href="../computer_whoiswho.html">Who is Who</a></li>
</ul>
</aside>
</div>
<!-- PRINTING STARTS HERE -->
<div class="row">
<div class="content">
<div class="col-md-7 middle-col">
<h1>JPA - Quick Guide</h1>
<div class="topgooglead">
<hr />
<div style="padding-bottom:5px;padding-left:10px;">Advertisements</div>
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 468;
google_ad_height = 60;
google_ad_format = "468x60_as";
google_ad_type = "image";
google_ad_channel = "";
//--></script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/f.txt"> 
</script>
</div>
<hr />
<div class="pre-btn">
<a href="jpa_criteria_api.html"><i class="icon icon-arrow-circle-o-left big-font"></i> Previous Page</a>
</div>
<div class="nxt-btn">
<a href="jpa_useful_resources.html">Next Page <i class="icon icon-arrow-circle-o-right big-font"></i>&nbsp;</a>
</div>
<div class="clearer"></div>
<hr />
<h1>JPA - Introduction</h1>
<p>Any enterprise application performs database operations by storing and retrieving vast amounts of data. Despite all the available technologies for storage management, application developers normally struggle to perform database operations efficiently.</p>
<p>Generally, Java developers use lots of code, or use the proprietary framework to interact with the database, whereas using JPA, the burden of interacting with the database reduces significantly. It forms a bridge between object models (Java program) and relational models (database program).</p>
<h2>Mismatches between relational and object models</h2>
<p>Relational objects are represented in a tabular format, while object models are represented in an interconnected graph of object format. While storing and retrieving an object model from a relational database, some mismatch occurs due to the following reasons:</p>
<ul class="list">
<li><p><b>Granularity</b> : Object model has more granularity than relational model.</p></li>
<li><p><b>Subtypes</b> : Subtypes (means inheritance) are not supported by all types of relational databases.</p></li>
<li><p><b>Identity</b> : Like object model, relational model does not expose identity while writing equality.</p></li>
<li><p><b>Associations</b> : Relational models cannot determine multiple relationships while looking into object domain model.</p></li>
<li><p><b>Data navigation</b> : Data navigation between objects in an object network is different in both models.</p></li>
</ul>
<h2>What is JPA?</h2>
<p>Java Persistence API is a collection of classes and methods to persistently store the vast amounts of data into a database which is provided by the Oracle Corporation.</p>
<h2>Where to use JPA?</h2>
<p>To reduce the burden of writing codes for relational object management, a programmer follows the ‘JPA Provider’ framework, which allows easy interaction with database instance. Here the required framework is taken over by JPA.</p>
<img src="images/jpa_provider.png" alt="JPA" />
<h2>JPA History</h2>
<p>Earlier versions of EJB, defined persistence layer combined with business logic layer using javax.ejb.EntityBean Interface.</p>
<ul class="list">
<li><p>While introducing EJB 3.0, the persistence layer was separated and specified as JPA 1.0 (Java Persistence API). The specifications of this API were released along with the specifications of JAVA EE5 on May 11, 2006 using JSR 220.</p></li>
<li><p>JPA 2.0 was released with the specifications of JAVA EE6 on December 10, 2009 as a part of Java Community Process JSR 317.</p></li>
<li><p>JPA 2.1 was released with the specification of JAVA EE7 on April 22, 2013 using JSR 338.</p></li>
</ul>
<h2>JPA Providers</h2>
<p>JPA is an open source API, therefore various enterprise vendors such as Oracle, Redhat, Eclipse, etc. provide new products by adding the JPA persistence flavor in them. Some of these products include:</p>
<p><b>Hibernate, Eclipselink, Toplink, Spring Data JPA, etc.</b></p>
<h1>JPA - Architecture</h1>
<p>Java Persistence API is a source to store business entities as relational entities. It shows how to define a Plain Oriented Java Object (POJO) as an entity and how to manage entities with relations.</p>
<h2>Class Level Architecture</h2>
<p>The following image shows the class level architecture of JPA. It shows the core classes and interfaces of JPA.</p>
<img src="images/jpa_class_level_architecture.png" alt="JPA Class Level Architecture" />
<p>The following table describes each of the units shown in the above architecture.</p>
<table class="table table-bordered">
<tr>
<th>Units</th>
<th>Description</th>
</tr>
<tr>
<td><b>EntityManagerFactory</b></td>
<td>This is a factory class of EntityManager. It creates and manages multiple EntityManager instances.</td>
</tr>
<tr>
<td><b>EntityManager</b></td>
<td>It is an Interface, it manages the persistence operations on objects. It works like factory for Query instance.</td>
</tr>
<tr>
<td><b>Entity</b></td>
<td>Entities are the persistence objects, stores as records in the database.</td>
</tr>
<tr>
<td><b>EntityTransaction</b></td>
<td>It has one-to-one relationship with EntityManager. For each EntityManager, operations are maintained by EntityTransaction class.</td>
</tr>
<tr>
<td><b>Persistence</b></td>
<td>This class contain static methods to obtain EntityManagerFactory instance.</td>
</tr>
<tr>
<td><b>Query</b></td>
<td>This interface is implemented by each JPA vendor to obtain relational objects that meet the criteria.</td>
</tr>
</table>
<p>The above classes and interfaces are used for storing entities into a database as a record. They help programmers by reducing their efforts to write codes for storing data into a database so that they can concentrate on more important activities such as writing codes for mapping the classes with database tables.</p>
<h2>JPA Class Relationships</h2>
<p>In the above architecture, the relations between the classes and interfaces belong to the javax.persistence package. The following diagram shows the relationship between them.</p>
<img src="images/jpa_class_relationships.png" alt="JPA Class Relationships" />
<ul class="list">
<li><p>The relationship between EntityManagerFactory and EntityManager is <b>one-to-many</b>. It is a factory class to EntityManager instances.</p></li>
<li><p>The relationship between EntityManager and EntityTransaction is <b>one-to-one</b>. For each EntityManager operation, there is an EntityTransaction instance.</p></li>
<li><p>The relationship between EntityManager and Query is <b>one-to-many</b>. Many number of queries can execute using one EntityManager instance.</p></li>
<li><p>The relationship between EntityManager and Entity is <b>one-to-many</b>. One EntityManager instance can manage multiple Entities.</p></li>
</ul>
<h1>JPA - ORM Components</h1>
<p>Most contemporary applications use relational database to store data. Recently, many vendors switched to object database to reduce their burden on data maintenance. It means object database or object relational technologies are taking care of storing, retrieving, updating, and maintaining data. The core part of this object relational technology is mapping orm.xml files. As xml does not require compilation, we can easily make changes to multiple data sources with less administration.</p>
<h2>Object Relational Mapping</h2>
<p>Object Relational Mapping (ORM) briefly tells you about what is ORM and how it works. ORM is a programming ability to covert data from object type to relational type and vice versa.</p>
<p>The main feature of ORM is mapping or binding an object to its data in the database. While mapping, we have to consider the data, the type of data, and its relations with self-entity or entities in any other table.</p>
<h2>Advanced Features</h2>
<ul class="list">
<li><p><b>Idiomatic persistence</b> : It enables you to write the persistence classes using object oriented classes.</p></li>
<li><p><b>High Performance</b> : It has many fetching techniques and hopeful locking techniques.</p></li>
<li><p><b>Reliable</b> : It is highly stable and Used by many professional programmers.</p></li>
</ul>
<h2>ORM Architecture</h2>
<p>The ORM architecture looks as follows.</p>
<img src="images/object_relational_mapping.png" alt="Object Relational Mapping" />
<p>The above architecture explains how object data is stored into relational database in three phases.</p>
<h3>Phase1</h3>
<p>The first phase, named as the <b>object data phase</b>, contains POJO classes, service interfaces, and classes. It is the main business component layer, which has business logic operations and attributes.</p>
<p>For example let us take an employee database as schema.</p>
<ul class="list">
<li><p>Employee POJO class contains attributes such as ID, name, salary, and designation. It also contains methods like setter and getter of those attributes.</p></li>
<li><p>Employee DAO/Service classes contain service methods such as create employee, find employee, and delete employee.</p></li>
</ul>
<h3>Phase 2</h3>
<p>The second phase, named as <b>mapping</b> or <b>persistence phase</b>, contains JPA provider, mapping file (ORM.xml), JPA Loader, and Object Grid.</p>
<ul class="list">
<li><p><b>JPA Provider</b> : It is the vendor product that contains the JPA flavor (javax.persistence). For example Eclipselink, Toplink, Hibernate, etc.</p></li>
<li><p><b>Mapping file</b> : The mapping file (ORM.xml) contains mapping configuration between the data in a POJO class and data in a relational database.</p></li>
<li><p><b>JPA Loader</b> : The JPA loader works like a cache memory. It can load the relational grid data. It works like a copy of database to interact with service classes for POJO data (attributes of POJO class).</p></li>
<li><p><b>Object Grid</b> : It is a temporary location that can store a copy of relational data, like a cache memory. All queries against the database is first effected on the data in the object grid. Only after it is committed, it affects the main database.</p></li>
</ul>
<h3>Phase 3</h3>
<p>The third phase is the <b>relational data phase</b>. It contains the relational data that is logically connected to the business component. As discussed above, only when the business component commits the data, it is stored into the database physically. Until then, the modified data is stored in a cache memory as a grid format. The process of the obtaining the data is identical to that of storing the data.</p>
<p>The mechanism of the programmatic interaction of above three phases is called as <b>object relational mapping</b>.</p>
<h2>Mapping.xml</h2>
<p>The mapping.xml file is to instruct the JPA vendor to map the Entity classes with the database tables.</p>
<p>Let us take an example of Employee entity which contains four attributes. The POJO class of Employee entity named <b>Employee.java</b> is as follows:</p>
<pre class="prettyprint notranslate">
public class Employee 
{
	private int eid;
	private String ename;
	private double salary;
	private String deg;
	public Employee(int eid, String ename, double salary, String deg) 
	{
		super( );
		this.eid = eid;
		this.ename = ename;
		this.salary = salary;
		this.deg = deg;
	}
	
	public Employee( ) 
	{
		super();
	}
	
	public int getEid( ) 
	{
		return eid;
	}
	public void setEid(int eid)  
	{
		this.eid = eid;
	}
    public String getEname( ) 
	{
		return ename;
	}
	public void setEname(String ename) 
	{
		this.ename = ename;
	}
	
	public double getSalary( ) 
	{
		return salary;
	}
	public void setSalary(double salary) 
	{
		this.salary = salary;
	}
	
	public String getDeg( ) 
	{
		return deg;
	}
	public void setDeg(String deg) 
	{
		this.deg = deg;
	}
}
</pre>
<p>The above code is the Employee entity POJO class. It contain four attributes <b>eid</b>, <b>ename</b>, <b>salary</b>, and <b>deg</b>. Consider these attributes as the table fields in a table and <b>eid</b> as the primary key of this table. Now we have to design the hibernate mapping file for it. The mapping file named <b>mapping.xml</b> is as follows:</p>
<pre class="prettyprint notranslate">
&lt;? xml version="1.0" encoding="UTF-8" ?&gt;
&lt;entity-mappings xmlns="http://java.sun.com/xml/ns/persistence/orm"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://java.sun.com/xml/ns/persistence/orm    
                        http://java.sun.com/xml/ns/persistence/orm_1_0.xsd"
                        version="1.0"&gt;
    &lt;description&gt; XML Mapping file&lt;/description&gt;
    &lt;entity class="Employee"&gt;        
        &lt;table name="EMPLOYEETABLE"/&gt;
        &lt;attributes&gt;
            &lt;id name="eid"&gt;
                &lt;generated-value strategy="TABLE"/&gt;
            &lt;/id&gt;
            &lt;basic name="ename"&gt;
                &lt;column name="EMP_NAME" length="100"/&gt;
            &lt;/basic&gt;
            &lt;basic name="salary"&gt;
            &lt;/basic&gt;
            &lt;basic name="deg"&gt;
            &lt;/basic&gt;
        &lt;/attributes&gt;
    &lt;/entity&gt;
&lt;/entity-mappings&gt;
</pre>
<p>The above script is used for mapping the entity class with the database table. In this file</p>
<ul class="list">
<li><p><b>&lt;entity-mappings&gt;</b> : tag defines the schema definition to allow entity tags into xml file.</p></li>
<li><p><b>&lt;description&gt;</b> : tag provides a description about application.</p></li>
<li><p><b>&lt;entity&gt;</b> : tag defines the entity class which you want to convert into table in a database. Attribute class defines the POJO entity class name.</p></li>
<li><p><b>&lt;table&gt;</b> : tag defines the table name. If you want to have identical names for both the class as well as the table, then this tag is not necessary.</p></li>
<li><p><b>&lt;attributes&gt;</b> : tag defines the attributes (fields in a table).</p></li>
<li><p><b>&lt;id&gt;</b> : tag defines the primary key of the table. The <b>&lt;generated-value&gt;</b> tag defines how to assign the primary key value such as <b>Automatic</b>, <b>Manual</b>, or taken from <b>Sequence</b>.</p>
<li><p><b>&lt;basic&gt;</b> : tag is used for defining remaining attributes for table.</p></li>
<li><p><b>&lt;column-name&gt;</b> : tag is used to define user-defined table field names in the table.</p></li>
</ul>
<h2>Annotations</h2>
<p>Generally xml files are used to configure specific components, or mapping two different specifications of components. In our case, we have to maintain xml files separately in a framework. That means while writing a mapping xml file, we need to compare the POJO class attributes with entity tags in the mapping.xml file.</p>
<p>Here is the solution. In the class definition, we can write the configuration part using annotations. Annotations are used for classes, properties, and methods. Annotations start with ‘@’ symbol. Annotations are declared prior to a class, property, or method. All annotations of JPA are defined in the <b>javax.persistence</b> package.</p>
<p>Here list of annotations used in our examples are given below.</p>
<table class="table table-bordered">
<tr>
<th>Annotation</th>
<th>Description</th>
</tr>
<tr>
<td>@Entity</td>
<td>Declares the class as an entity or a table.</td>
</tr>
<tr>
<td>@Table</td>
<td>Declares table name.</td>
</tr>
<tr>
<td>@Basic</td>
<td>Specifies non-constraint fields explicitly.</td>
</tr>
<tr>
<td>@Embedded</td>
<td>Specifies the properties of class or an entity whose value is an instance of an embeddable class.</td>
</tr>
<tr>
<td>@Id</td>
<td>Specifies the property, use for identity (primary key of a table) of the class.</td>
</tr>
<tr>
<td>@GeneratedValue</td>
<td>Specifies how the identity attribute can be initialized such as automatic, manual, or value taken from a sequence table.</td>
</tr>
<tr>
<td>@Transient</td>
<td>Specifies the property that is not persistent, i.e., the value is never stored in the database.</td>
</tr>
<tr>
<td>@Column</td>
<td>Specifies the column attribute for the persistence property.</td>
</tr>
<tr>
<td>@SequenceGenerator</td>
<td>Specifies the value for the property that is specified in the @GeneratedValue annotation. It creates a sequence.</td>
</tr>
<tr>
<td>@TableGenerator</td>
<td>Specifies the value generator for the property specified in the @GeneratedValue annotation. It creates a table for value generation.</td>
</tr>
<tr>
<td>@AccessType</td>
<td>This type of annotation is used to set the access type. If you set @AccessType(FIELD), then access occurs Field wise. If you set @AccessType(PROPERTY), then access occurs Property wise.</td>
</tr>
<tr>
<td>@JoinColumn</td>
<td>Specifies an entity association or entity collection. This is used in many- to-one and one-to-many associations.</td>
</tr>
<tr>
<td>@UniqueConstraint</td>
<td>Specifies the fields and the unique constraints for the primary or the secondary table.</td>
</tr>
<tr>
<td>@ColumnResult</td>
<td>References the name of a column in the SQL query using select clause.</td>
</tr>
<tr>
<td>@ManyToMany</td>
<td>Defines a many-to-many relationship between the join Tables.</td>
</tr>
<tr>
<td>@ManyToOne</td>
<td>Defines a many-to-one relationship between the join Tables.</td>
</tr>
<tr>
<td>@OneToMany</td>
<td>Defines a one-to-many relationship between the join Tables.</td>
</tr>
<tr>
<td>@OneToOne</td>
<td>Defines a one-to-one relationship between the join Tables.</td>
</tr>
<tr>
<td>@NamedQueries</td>
<td>specifies list of named queries.</td>
</tr>
<tr>
<td>@NamedQuery</td>
<td>Specifies a Query using static name.</td>
</tr>
</table>
<h2>Java Bean Standard</h2>
<p>The Java class encapsulates the instance values and their behaviors into a single unit called object. Java Bean is a temporary storage and reusable component or an object. It is a serializable class which has a default constructor and getter and setter methods to initialize the instance attributes individually.</p>
<h2>Bean Conventions</h2>
<ul class="list">
<li><p>Bean contains its default constructor or a file that contains serialized instance. Therefore, a bean can instantiate another bean.</p></li>
<li><p>The properties of a bean can be segregated into Boolean properties or non-Boolean properties.</p></li>
<li><p>Non-Boolean property contains <b>getter</b> and <b>setter</b> methods.</p></li>
<li><p>Boolean property contain <b>setter</b> and <b>is</b> method.</p></li>
<li><p><b>Getter</b> method of any property should start with small lettered <b>get</b> (java method convention) and continued with a field name that starts with capital letter. For example, the field name is <b>salary</b> therefore the getter method of this field is <b>getSalary ()</b>.</p></li>
<li><p><b>Setter</b> method of any property should start with small lettered <b>set</b> (java method convention), continued with a field name that starts with capital letter and the <b>argument value</b> to set to field. For example, the field name is <b>salary</b> therefore the setter method of this field is <b>setSalary ( double sal )</b>.</p></li>
<li><p>For Boolean property, <b>is</b> method to check if it is true or false. For Example the Boolean property <b>empty</b>, the <b>is</b> method of this field is <b>isEmpty ()</b>.</p></li>
</ul>
<h1>JPA - Installation</h1>
<p>This chapter takes you through the process of setting up JPA on Windows and Linux based systems. JPA can be easily installed and integrated with your current Java environment following a few simple steps without any complex setup procedures. User administration is required while installation.</p>
<h2>System Requirements</h2>
<table class="table table-bordered">
<tr>
<td>JDK</td>
<td>Java SE 2 JDK 1.5 or above</td>
</tr>
<tr>
<td>Memory</td>
<td>1 GB RAM (recommended)</td>
</tr>
<tr>
<td>Disk Space</td>
<td>No minimum requirement</td>
</tr>
<tr>
<td>Operating System Version</td>
<td>Windows XP or above, Linux</td>
</tr>
</table>
<p>Let us now proceed with the steps to install JPA.</p>
<h2>Step1: Verify your Java Installation</h2>
<p>First of all, you need to have Java Software Development Kit (SDK) installed on your system. To verify this, execute any of the following two commands depending on the platform you are working on.</p>
<p>If the Java installation has been done properly, then it will display the current version and specification of your Java installation. A sample output is given in the following table.</p>
<table class="table table-bordered">
<tr>
<th>Platform</th>
<th>Command</th>
<th>Sample Output</th>
</tr>
<tr>
<td>Windows</td>
<td><p>Open command console and type:</p>
<p><b>\&gt;java –version</b></p></td>
<td><p>Java version "1.7.0_60"</p>
<p>Java (TM) SE Run Time Environment (build 1.7.0_60-b19)</p>
<p>Java Hotspot (TM) 64-bit Server VM (build 24.60-b09,mixed mode)</p></td>
</tr>
<tr>
<td>Linux</td>
<td><p>Open command terminal and type:</p>
<p><b>$java –version</b></p></td>
<td><p>java version "1.7.0_25"</p>
<p>Open JDK Runtime Environment (rhel-2.3.10.4.el6_4-x86_64)</p>
<p>Open JDK 64-Bit Server VM (build 23.7-b01, mixed mode)</p></td>
</tr>
</table>
<ul class="list">
<li><p>We assume the readers of this tutorial have Java SDK version 1.7.0_60 installed on their system.</p></li>
<li><p>In case you do not have Java SDK, download its current version from <a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html" target="_blank" rel="nofollow">http://www.oracle.com/technetwork/java/javase/downloads/index.html</a> and have it installed.</p></li>
</ul>
<h2>Step 2: Set your Java Environment</h2>
<p>Set the environment variable JAVA_HOME to point to the base directory location where Java is installed on your machine. For example,</p>
<table class="table table-bordered">
<tr>
<th>Platform</th>
<th>Description</th>
</tr>
<tr>
<td>Windows</td>
<td>Set JAVA_HOME to C:\ProgramFiles\java\jdk1.7.0_60</td>
</tr>
<tr>
<td>Linux</td>
<td>Export  JAVA_HOME=/usr/local/java-current</td>
</tr>
</table>
<p>Append the full path of Java compiler location to the System Path.</p>
<table class="table table-bordered">
<tr>
<th>Platform</th>
<th>Description</th>
</tr>
<tr>
<td>Windows</td>
<td>Append the String "C:\Program Files\Java\jdk1.7.0_60\bin" to the end of the system variable PATH.</td>
</tr>
<tr>
<td>Linux</td>
<td> Export PATH=$PATH:$JAVA_HOME/bin/</td>
</tr>
</table>
<p>Execute the command <b>java -version</b> from the command prompt as explained above.</p>
<h2>Step3: Installing JPA</h2>
<p>You can go through the JPA installation by using any of the JPA Providers from this tutorial, e.g., Eclipselink, Hibernate. Let us follow the JPA installation using Eclipselink. For JPA programming, we require to follow the specific folder framework, therefore it is better to use IDE.</p>
<p>Download Eclipse IDE form following link <a href="https://www.eclipse.org/downloads/" target="_blank" rel="nofollow">https://www.eclipse.org/downloads/</a> Choose the EclipseIDE for JavaEE developer that is <b>Eclipse indigo</b>.</p>
<p>Unzip the Eclipse zip file in C drive. Open Eclipse IDE.</p>
<img src="images/installing_jpa.png" alt="Installing JPA" />
<h3>Installing JPA using Eclipselink</h3>
<p>Eclipselink is a library therefore we cannot add it directly to Eclipse IDE. For installing JPA using Eclipselink you need to follow the steps given below.</p>
<ul class="list">
<li><p>Create a new JPA project by selecting <b>File->New->JPA Project</b> in the Eclipse IDE as follows:</p>
<img src="images/new_jpa.png" alt="New JPA" /></li>
<li><p>You will get a dialog box named <b>New JPA Project</b>. Enter project name <b>tutorialspoint_JPA_Eclipselink</b>, check the <b>jre</b> version and click next:</p>
<img src="images/dialog_box.png" alt="Dialog Box" /></li>
<li><p>Click on download library (if you do not have the library) in the user library section.</p>
<img src="images/download_library.png" alt="Download Library" /></li>
<li><p>Select the latest version of Eclipselink library in the Download library dialog box and click next as follows:</p>
<img src="images/download_library_dialog_box.png" alt="Download Library Dialog Box" /></li>
<li><p>Accept the terms of license and click finish for download library.</p>
<img src="images/license.png" alt="License" /></li>
<li><p>6.	Downloading starts as is shown in the following screenshot.</p>
<img src="images/process.png" alt="Process" /></li>
<li><p>After downloading, select the downloaded library in the user library section and click finish.</p>
<img src="images/library_section.png" alt="Library Section" /></li>
<li><p>Finally you get the project file in the <b>Package Explorer</b> in Eclipse IDE. Extract all files, you will get the folder and file hierarchy as follows:</p>
<img src="images/package_explorer.png" alt="Package Explorer" /></li>
</ul>
<h2>Adding MySQL connector to Project</h2>
<p>Any example that we discuss here requires database connectivity. Let us consider MySQL database for database operations. It requires mysql-connector jar to interact with a Java program.</p>
<p>Follow the steps to configure the database jar in your project.</p>
<ul class="list">
<li><p>Go to Project properties <b>-></b> Java Build Path by right click on it. You will get a dialog box as shown in the following screen-shot. Click on Add External Jars.</p>
<img src="images/external_jars.png" alt="External Jars" /></li>
<li><p>Go to the jar location in your system memory, select the file and click on open.</p>
<img src="images/jar_locations.png" alt="Jar Location" /></li>
<li><p>Click ok on properties dialog. You will get the MySQL-connector Jar into your project. Now you are able to do database operations using MySQL.</p></li>
</ul>
<h1>JPA - Entity Managers</h1>
<p>This chapter uses a simple example to demonstrate how JPA works. Let us consider Employee Management as an example. Suppose the Employee Management creates, updates, finds, and deletes the records of an employee. As mentioned, we are using MySQL database for database operations.</p>
<p>The main modules for this example are as follows:</p>
<ul class="list">
<li><p><b>Model or POJO</b></p>
<p>Employee.java</p></li>
<li><p><b>Persistence</b></p>
<p>Persistence.xml</p></li>
<li><p><b>Service</b></p>
<p>CreatingEmployee.java</p>
<p>UpdatingEmployee.java</p>
<p>FindingEmployee.java</p>
<p>DeletingEmployee.java</p>
</li>
</ul>
<p>Let us take the package hierarchy which we have used in the JPA installation with Eclipselink. Follow the hierarchy for this example as shown below:</p>
<img src="images/package_hierarchy.png" alt="Package Hierarchy" />
<h2>Creating Entities</h2>
<p>Entities are nothing but beans or models. In this example, we will use <b>Employee</b> as an entity. <b>eid</b>, <b>ename</b>, <b>salary</b>, and <b>deg</b> are the attributes of this entity. It contains a default constructor as well as the setter and getter methods of those attributes.</p>
<p>In the above shown hierarchy, create a package named <b>‘com.tutorialspoint.eclipselink.entity’</b>, under <b>‘src’</b> (Source) package. Create a class named <b>Employee.java</b> under given package as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.entity;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.Table;

@Entity
@Table
public class Employee 
{
	@Id
	@GeneratedValue(strategy= GenerationType.AUTO) 	
	private int eid;
	private String ename;
	private double salary;
	private String deg;
	public Employee(int eid, String ename, double salary, String deg) 
	{
		super( );
		this.eid = eid;
		this.ename = ename;
		this.salary = salary;
		this.deg = deg;
	}
	
	public Employee( ) 
	{
		super();
	}
	
	public int getEid( ) 
	{
		return eid;
	}
	public void setEid(int eid)  
	{
		this.eid = eid;
	}
    public String getEname( ) 
	{
		return ename;
	}
	public void setEname(String ename) 
	{
		this.ename = ename;
	}
	
	public double getSalary( ) 
	{
		return salary;
	}
	public void setSalary(double salary) 
	{
		this.salary = salary;
	}
	
	public String getDeg( ) 
	{
		return deg;
	}
	public void setDeg(String deg) 
	{
		this.deg = deg;
	}
	@Override
	public String toString() {
		return "Employee [eid=" + eid + ", ename=" + ename + ", salary="
				+ salary + ", deg=" + deg + "]";
	}
}
</pre>
<p>In the above code, we have used @Entity annotation to make this POJO class an entity.</p>
<p>Before going to next module we need to create database for relational entity, which will register the database in <b>persistence.xml</b> file. Open MySQL workbench and type hte following query.</p>
<pre class="prettyprint notranslate">
create database jpadb
use jpadb
</pre>
<h3>Persistence.xml</h3>
<p>This module plays a crucial role in the concept of JPA. In this xml file we will register the database and specify the entity class.</p>
<p>In the above shown package hierarchy, persistence.xml under JPA Content package is as follows:</p>
<pre class="prettyprint notranslate">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"&gt;
	&lt;persistence-unit name="Eclipselink_JPA" 
                        transaction-type="RESOURCE_LOCAL"&gt;
                         	&lt;class&gt;com.tutorialspoint.eclipselink.entity.Employee&lt;/class&gt;
	&lt;properties&gt;
	   &lt;property name="javax.persistence.jdbc.url"
                   value="jdbc:mysql://localhost:3306/jpadb"/&gt;
     	   &lt;property name="javax.persistence.jdbc.user" value="root"/&gt;
	       &lt;property name="javax.persistence.jdbc.password" value="root"/&gt;
	       &lt;property name="javax.persistence.jdbc.driver"
                   value="com.mysql.jdbc.Driver"/&gt;
           &lt;property name="eclipselink.logging.level" value="FINE"/&gt;
	       &lt;property name="eclipselink.ddl-generation" 
		           value="create-tables"/&gt;
	&lt;/properties&gt;
	&lt;/persistence-unit&gt;
&lt;/persistence&gt;
</pre>
<p>In the above xml, <b>&lt;persistence-unit&gt; </b> tag is defined with a specific name for JPA persistence. The <b>&lt;class&gt;</b> tag defines entity class with package name. The <b>&lt;properties&gt;</b> tag defines all the properties, and <b>&lt;property&gt;</b> tag defines each property such as database registration, URL specification, username, and password. These are the Eclipselink properties. This file will configure the database.</p>
<h2>Persistence Operations</h2>
<p>Persistence operations are used for interacting with a database and they are <b>load</b> and <b>store</b> operations. In a business component, all the persistence operations fall under service classes.</p> 
<p>In the above shown package hierarchy, create a package named  <b>‘com.tutorialspoint.eclipselink.service’</b>, under <b>‘src’</b> (source) package. All the service classes named as CreateEmloyee.java, UpdateEmployee.java, FindEmployee.java, and DeleteEmployee.java. comes under the given package as follows:</p>
<h2> Create Employee</h2>
<p>The following code segment shows how to create an Employee class named <b>CreateEmployee.java</b>.</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.service;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import com.tutorialspoint.eclipselink.entity.Employee;

public class CreateEmployee 
{
	public static void main( String[ ] args ) 
	{
		EntityManagerFactory emfactory = Persistence.
				createEntityManagerFactory( "Eclipselink_JPA" );
		EntityManager entitymanager = emfactory.
				createEntityManager( );
		entitymanager.getTransaction( ).begin( );
		
		Employee employee = new Employee( ); 
		employee.setEid( 1201 );
		employee.setEname( "Gopal" );
		employee.setSalary( 40000 );
		employee.setDeg( "Technical Manager" );
		entitymanager.persist( employee );
		entitymanager.getTransaction( ).commit( );
		
		entitymanager.close( );
		emfactory.close( );
	}
}
</pre>
<p>In the above code the <b>createEntityManagerFactory ()</b> creates a persistence unit by providing the  same unique name which we provide for persistence-unit in persistent.xml file. The <b>entitymanagerfactory</b> object will create the <b>entitymanger</b> instance by using <b>createEntityManager ()</b> method. The <b>entitymanager</b> object creates <b>entitytransaction</b> instance for transaction management. By using <b>entitymanager</b> object, we can persist entities into the database.</p>
<p>After compilation and execution of the above program you will get notifications from eclipselink library on the console panel of eclipse IDE.</p>
<p>For result, open the MySQL workbench and type the following queries.</p>
<pre class="prettyprint notranslate">
use jpadb
select * from employee
</pre>
<p>The effected database table named <b>employee</b> will be shown in a tabular format as follows:</p>
<table class="table table-bordered">
<tr>
<th>Eid</th>
<th>Ename</th>
<th>Salary</th>
<th>Deg</th>
</tr>
<tr>
<td>1201</td>
<td>Gopal</td>
<td>40000</td>
<td>Technical Manager</td>
</tr>
</table>
<h2>Update Employee</h2>
<p>To update the records of an employee, we need to retrieve the existing records form the database, make changes, and finally commit it to the database. The class named <b>UpdateEmployee.java</b> is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.service;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import com.tutorialspoint.eclipselink.entity.Employee;

public class UpdateEmployee 
{
	public static void main( String[ ] args ) 
	{
		EntityManagerFactory emfactory = Persistence.
				createEntityManagerFactory( "Eclipselink_JPA" );
		EntityManager entitymanager = emfactory.
				createEntityManager( );
				entitymanager.getTransaction( ).begin( );
		Employee employee=entitymanager.
				find( Employee.class, 1201 );
		//before update
		System.out.println( employee );
		employee.setSalary( 46000 );
		entitymanager.getTransaction( ).commit( );
        //after update
		System.out.println( employee );
		entitymanager.close();
		emfactory.close();
	}
}
</pre>
<p>After compilation and execution of the above program you will get notifications from Eclipselink library on the console panel of eclipse IDE.</p>
<p>For result, open the MySQL workbench and type the following queries.</p>
<pre class="prettyprint notranslate">
use jpadb
select * from employee
</pre>
<p>The effected database table named <b>employee</b> will be shown in a tabular format as follows:</p>
<table class="table table-bordered">
<tr>
<th>Eid</th>
<th>Ename</th>
<th>Salary</th>
<th>Deg</th>
</tr>
<tr>
<td>1201</td>
<td>Gopal</td>
<td>46000</td>
<td>Technical Manager</td>
</tr>
</table>
<p>The salary of employee, 1201 is updated to 46000.</p>
<h2>Find Employee</h2>
<p>To find the records of an employee, we will have to retrieve the existing data from the database and display it. In this operation, EntityTransaction is not applied while retrieving a record.</p>
<p>The class named <b>FindEmployee.java</b> as follows.</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.service;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import com.tutorialspoint.eclipselink.entity.Employee;

public class FindEmployee 
{
	public static void main( String[ ] args ) 
	{
		EntityManagerFactory emfactory = Persistence
				.createEntityManagerFactory( "Eclipselink_JPA" );
		EntityManager entitymanager = emfactory.
				createEntityManager();
		Employee employee = entitymanager.
				find( Employee.class, 1201 );
		
		System.out.println("employee ID = "+employee.getEid( ));
		System.out.println("employee NAME = "+employee.getEname( ));
		System.out.println("employee SALARY = "+employee.getSalary( ));
		System.out.println("employee DESIGNATION = "+employee.getDeg( ));
	}
}
</pre>
<p>After compiling and executing the above program, you will get the following output from the Eclipselink library on the console panel of eclipse IDE.</p>
<pre class="prettyprint notranslate">
employee ID = 1201
employee NAME = Gopal
employee SALARY = 46000.0
employee DESIGNATION = Technical Manager
</pre>
<h2>Deleting Employee</h2>
<p>To delete the records of an employee, first we will find the existing records and then delete it. Here EntityTransaction plays an important role.</p>
<p>The class named <b>DeleteEmployee.java</b> as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.service;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import com.tutorialspoint.eclipselink.entity.Employee;

public class DeleteEmployee 
{
	public static void main( String[ ] args ) 
	{
		EntityManagerFactory emfactory = Persistence.
				createEntityManagerFactory( "Eclipselink_JPA" );
		EntityManager entitymanager = emfactory.
				createEntityManager( );
		entitymanager.getTransaction( ).begin( );
		Employee employee=entitymanager.
				find( Employee.class, 1201 );
		entitymanager.remove( employee );
		entitymanager.getTransaction( ).commit( );
		entitymanager.close( );
		emfactory.close( );
	}
}
</pre>
<p>After compilation and execution of the above program you will get notifications from Eclipselink library on the console panel of eclipse IDE.</p>
<p>For result, open the MySQL workbench and type the following queries.</p>
<pre class="prettyprint notranslate">
use jpadb
select * from employee
</pre>
<p>The effected database named <b>employee</b> will have null records.</p>
<p>After completion of all the modules in this example, the package and file hierarchy looks as follows:</p>
<img src="images/modules.png" alt="Modules" />
<h1>JPA - JPQL</h1>
<p>This chapter describes about JPQL and how it works with persistence units. In this chapter, the given examples follow the same package hierarchy, which we used in the previous chapter.</p>
<img src="images/jpa_jpql.png" alt="JPA JPQL" />
<h2>Java Persistence Query language</h2>
<p>JPQL stands for Java Persistence Query Language. It is used to create queries against entities to store in a relational database. JPQL is developed based on SQL syntax. But it won’t affect the database directly.</p>
<p>JPQL can retrieve data using SELECT clause, can do bulk updates using UPDATE clause and DELETE clause.</p>
<h2>Query Structure</h2>
<p>JPQL syntax is very similar to the syntax of SQL. Having SQL like syntax is an advantage because SQL is simple and being widely used. SQL works directly against relational database tables, records, and fields, whereas JPQL works with Java classes and instances.</p>
<p>For example, a JPQL query can retrieve an entity object rather than field result set from a database, as with SQL. The JPQL query structure as follows.</p>
<pre class="prettyprint notranslate">
SELECT ... FROM ...
[WHERE ...]
[GROUP BY ... [HAVING ...]]
[ORDER BY ...]
</pre>
<p>The structure of JPQL DELETE and UPDATE queries are as follows.</p>
<pre class="prettyprint notranslate">
DELETE FROM ... [WHERE ...]
 
UPDATE ... SET ... [WHERE ...]
</pre>
<h2>Scalar and Aggregate Functions</h2>
<p>Scalar functions return resultant values based on input values. Aggregate functions return the resultant values by calculating the input values.</p>
<p>We will use the same example Employee Management as in the previous chapter. Here we will go through the service classes using scalar and aggregate functions of JPQL.</p>
<p>Let us assume the <b>jpadb.employee</b> table contains following records.</p>
<table class="table table-bordered">
<tr>
<th>Eid</th>
<th>Ename</th>
<th>Salary</th>
<th>Deg</th>
</tr>
<tr>
<td>1201</td>
<td>Gopal</td>
<td>40000</td>
<td>Technical Manager</td>
</tr>
<tr>
<td>1202</td>
<td>Manisha</td>
<td>40000</td>
<td>Proof Reader</td>
</tr>
<tr>
<td>1203</td>
<td>Masthanvali</td>
<td>40000</td>
<td>Technical Writer</td>
</tr>
<tr>
<td>1204</td>
<td>Satish</td>
<td>30000</td>
<td>Technical Writer</td>
</tr>
<tr>
<td>1205</td>
<td>Krishna</td>
<td>30000</td>
<td>Technical Writer</td>
</tr>
<tr>
<td>1206</td>
<td>Kiran</td>
<td>35000</td>
<td>Proof Reader</td>
</tr>
</table>
<p>Create a class named <b>ScalarandAggregateFunctions.java</b> under <b>com.tutorialspoint.eclipselink.service</b> package as follows.</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.service;

import java.util.List;
import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import javax.persistence.Query;

public class ScalarandAggregateFunctions 
{
	public static void main( String[ ] args ) 
	{
		EntityManagerFactory emfactory = Persistence.
				createEntityManagerFactory( "Eclipselink_JPA" );
		EntityManager entitymanager = emfactory.
				createEntityManager();
		//Scalar function
		Query query = entitymanager.
		createQuery("Select UPPER(e.ename) from Employee e");
		List&lt;String&gt; list=query.getResultList();
		
		for(String e:list)
		{
			System.out.println("Employee NAME :"+e);
		}
		//Aggregate function
		Query query1 = entitymanager.
				createQuery("Select MAX(e.salary) from Employee e");
		Double result=(Double) query1.getSingleResult();
		System.out.println("Max Employee Salary :"+result);
	}
}
</pre>
<p>After compilation and execution of the above program you will get the following output on the console panel of Eclipse IDE.</p>
<pre class="prettyprint notranslate">
Employee NAME :GOPAL
Employee NAME :MANISHA
Employee NAME :MASTHANVALI
Employee NAME :SATISH
Employee NAME :KRISHNA
Employee NAME :KIRAN
ax Employee Salary :40000.0
</pre>
<h2>Between, And, Like Keywords</h2>
<p><b>Between</b>, <b>And</b>, and <b>Like</b> are the main keywords of JPQL. These keywords are used after <b>Where clause</b> in a query.</p>
<p>Create a class named <b>BetweenAndLikeFunctions.java</b> under <b>com.tutorialspoint.eclipselink.service</b> package as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.service;

import java.util.List;
import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import javax.persistence.Query;
import com.tutorialspoint.eclipselink.entity.Employee;

public class BetweenAndLikeFunctions 
{
	public static void main( String[ ] args ) 
	{
		EntityManagerFactory emfactory = Persistence.
			createEntityManagerFactory( "Eclipselink_JPA" );
		EntityManager entitymanager = emfactory.
			createEntityManager();
		//Between
		Query query = entitymanager.
			createQuery( "Select e " +
					     "from Employee e " +
					     "where e.salary " +
					     "Between 30000 and 40000" )
		List&lt;Employee&gt; list=(List&lt;Employee&gt;)query.getResultList( );
		 
		for( Employee e:list )
		{
			System.out.print("Employee ID :"+e.getEid( ));
			System.out.println("\t Employee salary :"+e.getSalary( ));
		}
		
		//Like
		Query query1 = entitymanager.
			createQuery("Select e " +
					    "from Employee e " +
					    "where e.ename LIKE 'M%'");
		List&lt;Employee&gt; list1=(List&lt;Employee&gt;)query1.getResultList( );
		for( Employee e:list1 )
		{
			System.out.print("Employee ID :"+e.getEid( ));
			System.out.println("\t Employee name :"+e.getEname( ));
		}
	}
}
</pre>
<p>After compiling and executing the above program, you will get the following output in the console panel of Eclipse IDE.</p>
<pre class="prettyprint notranslate">
Employee ID :1201	 Employee salary :40000.0
Employee ID :1202	 Employee salary :40000.0
Employee ID :1203	 Employee salary :40000.0
Employee ID :1204	 Employee salary :30000.0
Employee ID :1205	 Employee salary :30000.0
Employee ID :1206	 Employee salary :35000.0

Employee ID :1202	 Employee name :Manisha
Employee ID :1203	 Employee name :Masthanvali
</pre>
<h2>Ordering</h2>
<p>To order the records in JPQL, we use the ORDER BY clause. The usage of this clause is same as in SQL, but it deals with entities. The following example shows how to use the ORDER BY clause.</p>
<p>Create a class <b>Ordering.java</b> under <b>com.tutorialspoint.eclipselink.service</b> package as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.service;

import java.util.List;
import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import javax.persistence.Query;
import com.tutorialspoint.eclipselink.entity.Employee;

public class Ordering 
{
	public static void main( String[ ] args ) 
	{
		EntityManagerFactory emfactory = Persistence.
			createEntityManagerFactory( "Eclipselink_JPA" );
		EntityManager entitymanager = emfactory.
			createEntityManager();
		//Between
		Query query = entitymanager.
			createQuery( "Select e " +
					     "from Employee e " +
					     "ORDER BY e.ename ASC" );
		List&lt;Employee&gt; list=(List&lt;Employee&gt;)query.getResultList( );
		 
		for( Employee e:list )
		{
			System.out.print("Employee ID :"+e.getEid( ));
			System.out.println("\t Employee Name :"+e.getEname( ));
		}
	}
}
</pre>
<p>compiling and executing the above program you will produce the following output in the console panel of Eclipse IDE.</p>
<pre class="prettyprint notranslate">
Employee ID :1201	 Employee Name :Gopal
Employee ID :1206	 Employee Name :Kiran
Employee ID :1205	 Employee Name :Krishna
Employee ID :1202	 Employee Name :Manisha
Employee ID :1203	 Employee Name :Masthanvali
Employee ID :1204	 Employee Name :Satish
</pre>
<h2>Named Queries</h2>
<p>A @NamedQuery annotation is defined as a query with a predefined query string that is unchangeable. In contrast to dynamic queries, named queries may improve code organization by separating the JPQL query strings from POJO. It also passes the query parameters rather than embedding the literals dynamically into the query string and therefore produces more efficient queries.</p>
<p>First of all, add @NamedQuery annotation to the Employee entity class named <b>Employee.java</b> under <b>com.tutorialspoint.eclipselink.entity</b> package as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.entity;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.NamedQuery;
import javax.persistence.Table;

@Entity
@Table
@NamedQuery(query = "Select e from Employee e where e.eid = :id", 
		name = "find employee by id")
public class Employee 
{
	@Id
	@GeneratedValue(strategy= GenerationType.AUTO) 	
	private int eid;
	private String ename;
	private double salary;
	private String deg;
	public Employee(int eid, String ename, double salary, String deg) 
	{
		super( );
		this.eid = eid;
		this.ename = ename;
		this.salary = salary;
		this.deg = deg;
	}
	public Employee( ) 
	{
		super();
	}
	
	public int getEid( ) 
	{
		return eid;
	}
	public void setEid(int eid)  
	{
		this.eid = eid;
	}
	
	public String getEname( ) 
	{
		return ename;
	}
	public void setEname(String ename) 
	{
		this.ename = ename;
	}
	
	public double getSalary( ) 
	{
		return salary;
	}
	public void setSalary(double salary) 
	{
		this.salary = salary;
	}
	
	public String getDeg( ) 
	{
		return deg;
	}
	public void setDeg(String deg) 
	{
		this.deg = deg;
	}
	@Override
	public String toString() {
		return "Employee [eid=" + eid + ", ename=" + ename + ", salary="
				+ salary + ", deg=" + deg + "]";
	}
}
</pre>
<p>Create a class named <b>NamedQueries.java</b> under <b>com.tutorialspoint.eclipselink.service</b> package as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.service;

import java.util.List;
import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import javax.persistence.Query;
import com.tutorialspoint.eclipselink.entity.Employee;

public class NamedQueries 
{
	public static void main( String[ ] args ) 
	{
		EntityManagerFactory emfactory = Persistence.
			createEntityManagerFactory( "Eclipselink_JPA" );
		EntityManager entitymanager = emfactory.
			createEntityManager();
		Query query = entitymanager.createNamedQuery(
			"find employee by id");
		query.setParameter("id", 1204);
		List&lt;Employee&gt; list = query.getResultList( );
		for( Employee e:list )
		{
			System.out.print("Employee ID :"+e.getEid( ));
			System.out.println("\t Employee Name :"+e.getEname( ));
		}
	}
}
</pre>
<p>After compiling and executing of the above program you will get the following output in the console panel of Eclipse IDE.</p>
<pre class="prettyprint notranslate">
Employee ID :1204	 Employee Name :Satish
</pre>
<p>After adding all the above classes the package hierarchy looks as follows:</p>
<img src="images/package_hierarchy_2.png" alt="Package Hierarchy" />
<h2>Eager and Lazy Fetching</h2>
<p>The most important concept of JPA is to make a duplicate copy of the database in the cache memory. While transacting with a database, the JPA first creates a duplicate set of data and only when it is committed using an entity manager, the changes are effected into the database.</p>
<p>There are two ways of fetching records from the database.</p>
<h3>Eager fetch</h3>
<p>In eager fetching, related child objects are uploaded automatically while fetching a particular record.</p>
<h3>Lazy fetch</h3>
<p>In lazy fetching, related objects are not uploaded automatically unless you specifically request for them. First of all, it checks the availability of related objects and notifies. Later, if you call any of the getter method of that entity, then it fetches all the records.</p>
<p>Lazy fetch is possible when you try to fetch the records for the first time. That way, a copy of the whole record is already stored in the cache memory. Performance-wise, lazy fetch is preferable.</p>
<h1>JPA - Advanced Mappings</h1>
<p>JPA is a library which is released with Java specifications. Therefore, it supports all the object-oriented concepts for entity persistence. Till now, we are done with the basics of object relational mapping. This chapter takes you through the advanced mappings between objects and relational entities.</p>
<h2>Inheritance Strategies</h2>
<p>Inheritance is the core concept of any object-oriented language, therefore we can use inheritance relationships or strategies between entities. JPA support three types of inheritance strategies: SINGLE_TABLE, JOINED_TABLE, and TABLE_PER_CONCRETE_CLASS.</p>
<p>Let us consider an example. The following diagram shows three classes, viz. Staff, TeachingStaff, and NonTeachingStaff, and their relationships.</p>
<img src="images/inheritance_strategy.png" alt="Inheritance Strategy" />
<p>In the above diagram, Staff is an entity, while TeachingStaff and NonTeachingStaff are the sub-entities of Staff. Here we will use the above example to demonstrate all three three strategies of inheritance.</p>
<h2>Single Table strategy</h2>
<p>Single-table strategy takes all classes fields (both super and sub classes) and map them down into a single table known as SINGLE_TABLE strategy. Here the discriminator value plays a key role in differentiating the values of three entities in one table.</p>
<p>Let us consider the above example. TeachingStaff and NonTeachingStaff are the sub-classes of Staff. As per the concept of inheritance, a sub-class inherits the properties of its super-class. Therefore sid and sname are the fields that belong to both TeachingStaff and NonTeachingStaff. Create a JPA project. All the modules of this project are as follows:</p>
<h3> Creating Entities</h3>
<p>Create a package named <b>‘com.tutorialspoint.eclipselink.entity’</b> under <b>‘src’</b> package. Create a new java class named <b>Staff.java</b> under given package. The Staff entity class is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.entity;

import java.io.Serializable;
import javax.persistence.DiscriminatorColumn;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.Inheritance;
import javax.persistence.InheritanceType;
import javax.persistence.Table;
@Entity
@Table
@Inheritance( strategy = InheritanceType.SINGLE_TABLE )
@DiscriminatorColumn( name="type" )
public class Staff implements Serializable 
{
	@Id
	@GeneratedValue( strategy = GenerationType.AUTO )
	private int sid;
	private String sname;
	public Staff( int sid, String sname ) 
	{
		super( );
		this.sid = sid;
		this.sname = sname;
	}
	public Staff( ) 
	{
		super( );
	}
	public int getSid( ) 
	{
		return sid;
	}
	public void setSid( int sid ) 
	{
		this.sid = sid;
	}
	public String getSname( ) 
	{
		return sname;
	}
	public void setSname( String sname ) 
	{
		this.sname = sname;
	}
}
</pre>
<p>In the above code <b>@DescriminatorColumn</b> specifies the field name <b>(type)</b> and its values show the remaining (Teaching and NonTeachingStaff) fields.</p>
<p>Create a subclass (class) to Staff class named <b>TeachingStaff.java</b> under the <b>com.tutorialspoint.eclipselink.entity</b> package. The TeachingStaff Entity class is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.entity;

import javax.persistence.DiscriminatorValue;
import javax.persistence.Entity;

@Entity
@DiscriminatorValue( value="TS" )
public class TeachingStaff extends Staff 
{
	private String qualification;
	private String subjectexpertise;
	
	public TeachingStaff( int sid, String sname, 
			String qualification,String subjectexpertise ) 
	{
		super( sid, sname );
		this.qualification = qualification;
		this.subjectexpertise = subjectexpertise;
	}
	
	public TeachingStaff( ) 
	{
		super( );
	}

	public String getQualification( )
	{
		return qualification;
	}

	public void setQualification( String qualification )
	{
		this.qualification = qualification;
	}

	public String getSubjectexpertise( ) 
	{
		return subjectexpertise;
	}

	public void setSubjectexpertise( String subjectexpertise )
	{
		this.subjectexpertise = subjectexpertise;
	}
}
</pre>
<p>Create a subclass (class) to Staff class named <b>NonTeachingStaff.java</b> under the <b>com.tutorialspoint.eclipselink.entity</b> package. The NonTeachingStaff Entity class is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.entity;

import javax.persistence.DiscriminatorValue;
import javax.persistence.Entity;

@Entity
@DiscriminatorValue( value = "NS" )
public class NonTeachingStaff extends Staff 
{
	private String areaexpertise;

	public NonTeachingStaff( int sid, String sname, 
			String areaexpertise ) 
	{
		super( sid, sname );
		this.areaexpertise = areaexpertise;
	}

	public NonTeachingStaff( ) 
	{
		super( );
	}

	public String getAreaexpertise( ) 
	{
		return areaexpertise;
	}

	public void setAreaexpertise( String areaexpertise )
	{
		this.areaexpertise = areaexpertise;
	}
}
</pre>
<h3>Persistence.xml</h3>
<p>Persistence.xml contains the configuration information of database and the registration information of entity classes. The xml file is shown as follows:</p>
<pre class="prettyprint notranslate">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"&gt;
	&lt;persistence-unit name="Eclipselink_JPA" 
                        transaction-type="RESOURCE_LOCAL"&gt;
	    &lt;class&gt;com.tutorialspoint.eclipselink.entity.Staff&lt;/class&gt;
		&lt;class&gt;com.tutorialspoint.eclipselink.entity.NonTeachingStaff&lt;/class&gt;
		&lt;class&gt;com.tutorialspoint.eclipselink.entity.TeachingStaff&lt;/class&gt;
		&lt;properties&gt;
			&lt;property name="javax.persistence.jdbc.url" 
                            value="jdbc:mysql://localhost:3306/jpadb"/&gt;
			&lt;property name="javax.persistence.jdbc.user" value="root"/&gt;
			&lt;property name="javax.persistence.jdbc.password" 
                            value="root"/&gt;
			&lt;property name="javax.persistence.jdbc.driver" 
                            value="com.mysql.jdbc.Driver"/&gt;
			&lt;property name="eclipselink.logging.level" value="FINE"/&gt;
			&lt;property name="eclipselink.ddl-generation" 
                            value="create-tables"/&gt;
		&lt;/properties&gt;
	&lt;/persistence-unit&gt;
&lt;/persistence&gt;
</pre>
<h3>Service class</h3>
<p>Service classes are the implementation part of business component. Create a package under <b>‘src’</b> package named <b>‘com.tutorialspoint.eclipselink.service’</b>.</p>
<p>Create a class named <b>SaveClient.java</b> under the given package to store Staff, TeachingStaff, and NonTeachingStaff class fields. The SaveClient class is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.service;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import com.tutorialspoint.eclipselink.entity.NonTeachingStaff;
import com.tutorialspoint.eclipselink.entity.TeachingStaff;

public class SaveClient 
{
	public static void main( String[ ] args ) 
	{
		EntityManagerFactory emfactory = Persistence.
				createEntityManagerFactory( "Eclipselink_JPA" );
		EntityManager entitymanager = emfactory.
				createEntityManager( );
		entitymanager.getTransaction( ).begin( );
		
		//Teaching staff entity 
		TeachingStaff ts1=new TeachingStaff(
				1,"Gopal","MSc MEd","Maths");
		TeachingStaff ts2=new TeachingStaff(
				2, "Manisha", "BSc BEd", "English");
		//Non-Teaching Staff entity
		NonTeachingStaff nts1=new NonTeachingStaff(
				3, "Satish", "Accounts");
		NonTeachingStaff nts2=new NonTeachingStaff(
				4, "Krishna", "Office Admin");
		
		//storing all entities
		entitymanager.persist(ts1);
		entitymanager.persist(ts2);
		entitymanager.persist(nts1);
		entitymanager.persist(nts2);
		entitymanager.getTransaction().commit();
		entitymanager.close();
		emfactory.close();
	}
}
</pre>
<p>After compiling and executing the above program you will get notifications on the console panel of Eclipse IDE. Check MySQL workbench for output. The output in a tabular format is shown as follows:</p>
<table class="table table-bordered">
<tr>
<th>Sid</th>
<th>Type</th>
<th>Sname</th>
<th>Areaexpertise</th>
<th>Qualification</th>
<th>Subjectexpertise</th>
</tr>
<tr>
<td>1</td>
<td>TS</td>
<td>Gopal</td>
<td></td>
<td>MSC MED</td>
<td>Maths</td>
</tr>
<tr>
<td>2</td>
<td>TS</td>
<td>Manisha</td>
<td></td>
<td>BSC BED</td>
<td>English</td>
</tr>
<tr>
<td>3</td>
<td>NS</td>
<td>Satish</td>
<td>Accounts</td>
<td></td>
<td></td>
</tr>
<tr>
<td>4</td>
<td>NS</td>
<td>Krishna</td>
<td>Office Admin</td>
<td></td>
<td></td>
</tr>
</table>
<p>Finally you will get a single table containing the field of all the three classes with a discriminator column named <b>Type</b> (field).</p>
<h2>Joined table Strategy</h2>
<p>Joined table strategy is to share the referenced column that contains unique values to join the table and make easy transactions. Let us consider the same example as above.</p>
<p>Create a JPA Project. All the project modules are shown below.</p>
<h3>Creating Entities</h3>
<p>Create a package named <b>‘com.tutorialspoint.eclipselink.entity’</b> under <b>‘src’</b> package. Create a new java class named <b>Staff.java</b> under given package. The Staff entity class is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.entity;

import java.io.Serializable;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.Inheritance;
import javax.persistence.InheritanceType;
import javax.persistence.Table;

@Entity
@Table
@Inheritance( strategy = InheritanceType.JOINED )
public class Staff implements Serializable 
{
	@Id
	@GeneratedValue( strategy = GenerationType.AUTO )
	private int sid;
	private String sname;
	public Staff( int sid, String sname ) 
	{
		super( );
		this.sid = sid;
		this.sname = sname;
	}
	public Staff( ) 
	{
		super( );
	}
	public int getSid( ) 
	{
		return sid;
	}
	public void setSid( int sid ) 
	{
		this.sid = sid;
	}
	public String getSname( ) 
	{
		return sname;
	}
	public void setSname( String sname ) 
	{
		this.sname = sname;
	}
}
</pre>
<p>Create a subclass (class) to Staff class named <b>TeachingStaff.java</b> under the <b>com.tutorialspoint.eclipselink.entity</b> package. The TeachingStaff Entity class is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.entity;

import javax.persistence.DiscriminatorValue;
import javax.persistence.Entity;

@Entity
@PrimaryKeyJoinColumn(referencedColumnName="sid")
public class TeachingStaff extends Staff 
{
	private String qualification;
	private String subjectexpertise;
	
	public TeachingStaff( int sid, String sname, 
			String qualification,String subjectexpertise ) 
	{
		super( sid, sname );
		this.qualification = qualification;
		this.subjectexpertise = subjectexpertise;
	}
	
	public TeachingStaff( ) 
	{
		super( );
		
	}

	public String getQualification( )
	{
		return qualification;
	}

	public void setQualification( String qualification )
	{
		this.qualification = qualification;
	}

	public String getSubjectexpertise( ) 
	{
		return subjectexpertise;
	}

	public void setSubjectexpertise( String subjectexpertise )
	{
		this.subjectexpertise = subjectexpertise;
	}
}
</pre>
<p>Create a subclass (class) to Staff class named <b>NonTeachingStaff.java</b> under the <b>com.tutorialspoint.eclipselink.entity</b> package. The NonTeachingStaff Entity class is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.entity;

import javax.persistence.DiscriminatorValue;
import javax.persistence.Entity;

@Entity
@PrimaryKeyJoinColumn(referencedColumnName="sid")
public class NonTeachingStaff extends Staff 
{
	private String areaexpertise;

	public NonTeachingStaff( int sid, String sname, 
			String areaexpertise ) 
	{
		super( sid, sname );
		this.areaexpertise = areaexpertise;
	}

	public NonTeachingStaff( ) 
	{
		super( );
	}

	public String getAreaexpertise( ) 
	{
		return areaexpertise;
	}

	public void setAreaexpertise( String areaexpertise )
	{
		this.areaexpertise = areaexpertise;
	}
}
</pre>
<h3>Persistence.xml</h3>
<p>Persistence.xml file contains the configuration information of the database and the registration information of entity classes. The xml file is shown as follows:</p>
<pre class="prettyprint notranslate">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"&gt;
	&lt;persistence-unit name="Eclipselink_JPA" 
                        transaction-type="RESOURCE_LOCAL"&gt;
	&lt;class&gt;com.tutorialspoint.eclipselink.entity.Staff&lt;/class&gt;
	&lt;class&gt;com.tutorialspoint.eclipselink.entity.NonTeachingStaff&lt;/class&gt;
	&lt;class&gt;com.tutorialspoint.eclipselink.entity.TeachingStaff&lt;/class&gt;
		&lt;properties&gt;
			&lt;property name="javax.persistence.jdbc.url" 
                            value="jdbc:mysql://localhost:3306/jpadb"/&gt;
			&lt;property name="javax.persistence.jdbc.user" value="root"/&gt;
			&lt;property name="javax.persistence.jdbc.password" 
                            value="root"/&gt;
			&lt;property name="javax.persistence.jdbc.driver" 
                            value="com.mysql.jdbc.Driver"/&gt;
			&lt;property name="eclipselink.logging.level" value="FINE"/&gt;
			&lt;property name="eclipselink.ddl-generation" 
                            value="create-tables"/&gt;
		&lt;/properties&gt;
	&lt;/persistence-unit&gt;
&lt;/persistence&gt;
</pre>
<h3>Service class</h3>
<p>Service classes are the implementation part of business component. Create a package under <b>‘src’</b> package named <b>‘com.tutorialspoint.eclipselink.service’</b>.</p>
<p>Create a class named <b>SaveClient.java</b> under the given package to store fields of Staff, TeachingStaff, and NonTeachingStaff class. Then SaveClient class is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.service;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import com.tutorialspoint.eclipselink.entity.NonTeachingStaff;
import com.tutorialspoint.eclipselink.entity.TeachingStaff;

public class SaveClient 
{
	public static void main( String[ ] args ) 
	{
		EntityManagerFactory emfactory = Persistence.
				createEntityManagerFactory( "Eclipselink_JPA" );
		EntityManager entitymanager = emfactory.
				createEntityManager( );
		entitymanager.getTransaction( ).begin( );
		
		//Teaching staff entity 
		TeachingStaff ts1=new TeachingStaff(
				1,"Gopal","MSc MEd","Maths");
		TeachingStaff ts2=new TeachingStaff(
				2, "Manisha", "BSc BEd", "English");
		//Non-Teaching Staff entity
		NonTeachingStaff nts1=new NonTeachingStaff(
				3, "Satish", "Accounts");
		NonTeachingStaff nts2=new NonTeachingStaff(
		4, "Krishna", "Office Admin");
		
		//storing all entities
		entitymanager.persist(ts1);
		entitymanager.persist(ts2);
		entitymanager.persist(nts1);
		entitymanager.persist(nts2);
		
		entitymanager.getTransaction().commit();
		entitymanager.close();
		emfactory.close();
	}
}
</pre>
<p>After compiling and executing the above program you will get notifications in the console panel of Eclipse IDE. For output, check MySQL workbench.</p>
<p>Here three tables are created and the result of <b>staff</b> table is displayed in a tabular format.</p>
<table class="table table-bordered">
<tr>
<th>Sid</th>
<th>Dtype</th>
<th>Sname</th>
</tr>
<tr>
<td>1</td>
<td>TeachingStaff</td>
<td>Gopal</td>
</tr>
<tr>
<td>2</td>
<td>TeachingStaff</td>
<td>Manisha</td>
</tr>
<tr>
<td>3</td>
<td>NonTeachingStaff</td>
<td>Satish</td>
</tr>
<tr>
<td>4</td>
<td>NonTeachingStaff</td>
<td>Krishna</td>
</tr>
</table>
<p>The result of <b>TeachingStaff</b> table is displayed as follows:</p>
<table class="table table-bordered">
<tr>
<th>Sid</th>
<th>Qualification</th>
<th>Subjectexpertise</th>
</tr>
<tr>
<td>1</td>
<td>MSC MED</td>
<td>Maths</td>
</tr>
<tr>
<td>2</td>
<td>BSC BED</td>
<td>English</td>
</tr>
</table>
<p>In the above table sid is the foreign key (reference field form staff table) The result of <b>NonTeachingStaff</b> table is displayed as follows:</p>
<table class="table table-bordered">
<tr>
<th>Sid</th>
<th>Areaexpertise</th>
</tr>
<tr>
<td>3</td>
<td>Accounts</td>
</tr>
<tr>
<td>4</td>
<td>Office Admin</td>
</tr>
</table>
<p>Finally, the three tables are created using their respective fields and the SID field is shared by all the three tables. In the Staff table, SID is the primary key. In the remaining two tables (TeachingStaff and NonTeachingStaff), SID is the foreign key.</p>
<h2>Table per class strategy</h2>
<p>Table per class strategy is to create a table for each sub-entity. The Staff table will be created, but it will contain null values. The field values of Staff table must be shared by both TeachingStaff and NonTeachingStaff tables.</p>
<p>Let us consider the same example as above.</p>
<h3>Creating Entities</h3>
<p>Create a package named <b>‘com.tutorialspoint.eclipselink.entity’</b> under <b>‘src’</b> package. Create a new java class named <b>Staff.java</b> under given package. The Staff entity class is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.entity;

import java.io.Serializable;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.Inheritance;
import javax.persistence.InheritanceType;
import javax.persistence.Table;

@Entity
@Table
@Inheritance( strategy = InheritanceType.TABLE_PER_CLASS )
public class Staff implements Serializable 
{
	@Id
	@GeneratedValue( strategy = GenerationType.AUTO )
	private int sid;
	private String sname;
	public Staff( int sid, String sname ) 
	{
		super( );
		this.sid = sid;
		this.sname = sname;
	}
	public Staff( ) 
	{
		super( );
	}
	public int getSid( ) 
	{
		return sid;
	}
	public void setSid( int sid ) 
	{
		this.sid = sid;
	}
	public String getSname( ) 
	{
		return sname;
	}
	public void setSname( String sname ) 
	{
		this.sname = sname;
	}
}
</pre>
<p>Create a subclass (class) to Staff class named <b>TeachingStaff.java</b> under the <b>com.tutorialspoint.eclipselink.entity</b> package. The TeachingStaff Entity class is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.entity;

import javax.persistence.DiscriminatorValue;
import javax.persistence.Entity;

@Entity
public class TeachingStaff extends Staff 
{
	private String qualification;
	private String subjectexpertise;
	
	public TeachingStaff( int sid, String sname, 
			String qualification,String subjectexpertise ) 
	{
		super( sid, sname );
		this.qualification = qualification;
		this.subjectexpertise = subjectexpertise;
	}
	
	public TeachingStaff( ) 
	{
		super( );
		
	}

	public String getQualification( )
	{
		return qualification;
	}
	public void setQualification( String qualification )
	{
		this.qualification = qualification;
	}

	public String getSubjectexpertise( ) 
	{
		return subjectexpertise;
	}

	public void setSubjectexpertise( String subjectexpertise )
	{
		this.subjectexpertise = subjectexpertise;
	}
}
</pre>
<p>Create a subclass (class) to Staff class named <b>NonTeachingStaff.java</b> under the <b>com.tutorialspoint.eclipselink.entity</b> package. The NonTeachingStaff Entity class is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.entity;

import javax.persistence.DiscriminatorValue;
import javax.persistence.Entity;

@Entity
public class NonTeachingStaff extends Staff 
{
	private String areaexpertise;

	public NonTeachingStaff( int sid, String sname, 
			String areaexpertise )
			{
		super( sid, sname );
		this.areaexpertise = areaexpertise;
	}

	public NonTeachingStaff( ) 
	{
		super( );
	}

	public String getAreaexpertise( ) 
	{
		return areaexpertise;
	}

	public void setAreaexpertise( String areaexpertise )
	{
		this.areaexpertise = areaexpertise;
	}
}
</pre>
<h3>Persistence.xml</h3>
<p>Persistence.xml file contains the configuration information of database and registration information of entity classes. The xml file is shown as follows:</p>
<pre class="prettyprint notranslate">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/persistence http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"&gt;
	&lt;persistence-unit name="Eclipselink_JPA" 
                        transaction-type="RESOURCE_LOCAL"&gt;
	&lt;class&gt;com.tutorialspoint.eclipselink.entity.Staff&lt;/class&gt;
	&lt;class&gt;com.tutorialspoint.eclipselink.entity.NonTeachingStaff&lt;/class&gt;
	&lt;class&gt;com.tutorialspoint.eclipselink.entity.TeachingStaff&lt;/class&gt;
		&lt;properties&gt;
			&lt;property name="javax.persistence.jdbc.url" 
                            value="jdbc:mysql://localhost:3306/jpadb"/&gt;
			&lt;property name="javax.persistence.jdbc.user" value="root"/&gt;
			&lt;property name="javax.persistence.jdbc.password" 
                            value="root"/&gt;
			&lt;property name="javax.persistence.jdbc.driver" 
                            value="com.mysql.jdbc.Driver"/&gt;
			&lt;property name="eclipselink.logging.level" value="FINE"/&gt;
			&lt;property name="eclipselink.ddl-generation" 
                            value="create-tables"/&gt;
			&lt;/properties&gt;
	&lt;/persistence-unit&gt;
&lt;/persistence&gt;
</pre>
<h3>Service class</h3>
<p>Service classes are the implementation part of business component. Create a package under <b>‘src’</b> package named <b>‘com.tutorialspoint.eclipselink.service’</b>.</p>
<p>Create a class named <b>SaveClient.java</b> under the given package to store Staff, TeachingStaff, and NonTeachingStaff class fields. The SaveClient class is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.service;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import com.tutorialspoint.eclipselink.entity.NonTeachingStaff;
import com.tutorialspoint.eclipselink.entity.TeachingStaff;
public class SaveClient 
{
	public static void main( String[ ] args ) 
	{
		EntityManagerFactory emfactory = Persistence.
				createEntityManagerFactory( "Eclipselink_JPA" );
		EntityManager entitymanager = emfactory.
				createEntityManager( );
		entitymanager.getTransaction( ).begin( );
		
		//Teaching staff entity 
		TeachingStaff ts1=new TeachingStaff(
				1,"Gopal","MSc MEd","Maths");
		TeachingStaff ts2=new TeachingStaff(
				2, "Manisha", "BSc BEd", "English");
		//Non-Teaching Staff entity
		NonTeachingStaff nts1=new NonTeachingStaff(
				3, "Satish", "Accounts");
		NonTeachingStaff nts2=new NonTeachingStaff(
				4, "Krishna", "Office Admin");
		
		//storing all entities
		entitymanager.persist(ts1);
		entitymanager.persist(ts2);
		entitymanager.persist(nts1);
		entitymanager.persist(nts2);
		
		entitymanager.getTransaction().commit();
		entitymanager.close();
		emfactory.close();
	}
}
</pre>
<p>After compiling and executing the above program, you will get notifications on the console panel of Eclipse IDE. For output, check MySQL workbench.</p>
<p>Here the three tables are created and the <b>Staff</b> table contains null records.</p>
<p>The result of <b>TeachingStaff</b> is displayed as follows:</p>
<table class="table table-bordered">
<tr>
<th>Sid</th>
<th>Qualification</th>
<th>Sname</th>
<th>Subjectexpertise</th>
</tr>
<tr>
<td>1</td>
<td>MSC MED</td>
<td>Gopal</td>
<td>Maths</td>
</tr>
<tr>
<td>2</td>
<td>BSC BED</td>
<td>Manisha</td>
<td>English</td>
</tr>
</table>
<p>The above table TeachingStaff contains fields of both Staff and TeachingStaff Entities.</p>
<p>The result of <b>NonTeachingStaff</b> is displayed as follows:</p>
<table class="table table-bordered">
<tr>
<th>Sid</th>
<th>Areaexpertise</th>
<th>Sname</th>
</tr>
<tr>
<td>3</td>
<td>Accounts</td>
<td>Satish</td>
</tr>
<tr>
<td>4</td>
<td>Office Admin</td>
<td>Krishna</td>
</tr>
</table>
<p>The above table NonTeachingStaff contains fields of both Staff and NonTeachingStaff Entities.</p>
<h1>JPA - Entity Relationships</h1>
<p>This chapter takes you through the relationships between Entities. Generally the relations are more effective between tables in the database. Here the entity classes are treated as relational tables (concept of JPA), therefore the relationships between Entity classes are as follows:</p>
<ul class="list">
<li>@ManyToOne Relation</li>
<li>@OneToMany Relation</li>
<li>@OneToOne Relation</li>
<li>@ManyToMany Relation</li>
</ul>
<h2>@ManyToOne Relation</h2>
<p>Many-To-One relation between entities exists where one entity (column or set of columns) is referenced with another entity (column or set of columns) containing unique values. In relational databases, these relations are applied by using foreign key/primary key between the tables.</p>
<p>Let us consider an example of a relation between Employee and Department entities. In unidirectional manner, i.e., from Employee to Department, Many-To-One relation is applicable. That means each record of employee contains one department id, which should be a primary key in the Department table. Here in the Employee table, Department id is the foreign Key.</p>
<p>The following diagram shows the Many-To-One relation between the two tables.</p>
<img src="images/many_to_one_relation.png" alt="@ManyToOne Relation" />
<p>Create a JPA project in eclipse IDE named <b>JPA_Eclipselink_MTO</b>. All the modules of this project are discussed below.</p>
<h3>Creating Entities</h3>
<p>Follow the above given diagram for creating entities. Create a package named <b>‘com.tutorialspoin.eclipselink.entity’</b> under <b>‘src’</b> package. Create a class named <b>Department.java</b> under given package. The class Department entity is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.entity;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;

@Entity
public class Department 
{
    @Id 
    @GeneratedValue( strategy=GenerationType.AUTO )
    private int id;
    private String name;

    public int getId() 
    {
    	return id;
    }
    
    public void setId(int id) 
    {
    	this.id = id;
    }
    
    public String getName( )
    {
    	return name;
    }
    
    public void setName( String deptName )
    {
    	this.name = deptName;
    }
}
</pre>
<p>Create the second entity in this relation - Employee entity class named <b>Employee.java</b> under <b>‘com.tutorialspoint.eclipselink.entity’</b> package. The Employee entity class is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.entity;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.ManyToOne;

@Entity
public class Employee 
{
	@Id
	@GeneratedValue( strategy= GenerationType.AUTO ) 	
	private int eid;
	private String ename;
	private double salary;
	private String deg;
	@ManyToOne
	private Department department;
	
	public Employee(int eid, 
			String ename, double salary, String deg) 
	{
		super( );
		this.eid = eid;
		this.ename = ename;
		this.salary = salary;
		this.deg = deg;
	}
	
	public Employee( ) 
	{
		super();
	}
	
	public int getEid( ) 
	{
		return eid;
	}
	public void setEid(int eid)  
	{
		this.eid = eid;
	}
	
	public String getEname( ) 
	{
		return ename;
	}
	public void setEname(String ename) 
	{
		this.ename = ename;
	}
	
	public double getSalary( ) 
	{
		return salary;
	}
	public void setSalary(double salary) 
	{
		this.salary = salary;
	}
	
	public String getDeg( ) 
	{
		return deg;
	}
	public void setDeg(String deg) 
	{
		this.deg = deg;
	}
		
	public Department getDepartment() {
		return department;
	}

	public void setDepartment(Department department) {
		this.department = department;
	}
}
</pre>
<h3>Persistence.xml</h3>    
<p>Persistence.xml file is required to configure the database and the registration of entity classes.</p> 
<p>Persitence.xml will be created by the eclipse IDE while creating a JPA Project. The configuration details are user specifications. The persistence.xml file is shown as follows: </p>
<pre class="prettyprint notranslate">

&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;persistence version="2.0" 
             xmlns="http://java.sun.com/xml/ns/persistence" 
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
             xsi:schemaLocation="http://java.sun.com/xml/ns/persistence 
             http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"&gt;
	&lt;persistence-unit name="Eclipselink_JPA" 
                        transaction-type="RESOURCE_LOCAL"&gt;
	&lt;class&gt;com.tutorialspoint.eclipselink.entity.Employee&lt;/class&gt;
	&lt;class&gt;com.tutorialspoint.eclipselink.entity.Department&lt;/class&gt;
		&lt;properties&gt;
			&lt;property name="javax.persistence.jdbc.url" 
			          value="jdbc:mysql://localhost:3306/jpadb"/&gt;
			&lt;property name="javax.persistence.jdbc.user" value="root"/&gt;
			&lt;property name="javax.persistence.jdbc.password"
                            value="root"/&gt;
			&lt;property name="javax.persistence.jdbc.driver" 
			          value="com.mysql.jdbc.Driver"/&gt;
			&lt;property name="eclipselink.logging.level" value="FINE"/&gt;
			&lt;property name="eclipselink.ddl-generation" 
			          value="create-tables"/&gt;
		&lt;/properties&gt;
	&lt;/persistence-unit&gt;
&lt;/persistence&gt;
</pre>
<h3>Service Classes</h3>
<p>This module contains the service classes, which implements the relational part using the attribute initialization. Create a package under <b>‘src’</b> package named <b>‘com.tutorialspoint.eclipselink.service’</b>. The DAO class named <b>ManyToOne.java</b> is created under given package. The DAO class is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspointeclipselink.service;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import com.tutorialspoint.eclipselink.entity.Department;
import com.tutorialspoint.eclipselink.entity.Employee;

public class ManyToOne 
{
	public static void main( String[ ] args ) 
	{
		EntityManagerFactory emfactory = Persistence.
				createEntityManagerFactory( "Eclipselink_JPA" );
		EntityManager entitymanager = emfactory.
				createEntityManager( );
		entitymanager.getTransaction( ).begin( );
		
		//Create Department Entity
		Department department = new Department();
		department.setName("Development");
		//Store Department
		entitymanager.persist(department);
		
		//Create Employee1 Entity
		Employee employee1 = new Employee();
		employee1.setEname("Satish");
		employee1.setSalary(45000.0);
		employee1.setDeg("Technical Writer");
		employee1.setDepartment(department);

		//Create Employee2 Entity
		Employee employee2 = new Employee();
		employee2.setEname("Krishna");
		employee2.setSalary(45000.0);
		employee2.setDeg("Technical Writer");
		employee2.setDepartment(department);

		//Create Employee3 Entity
		Employee employee3 = new Employee();
		employee3.setEname("Masthanvali");
		employee3.setSalary(50000.0);
		employee3.setDeg("Technical Writer");
		employee3.setDepartment(department);
		
		//Store Employees
		entitymanager.persist(employee1);
		entitymanager.persist(employee2);
		entitymanager.persist(employee3);
				
		entitymanager.getTransaction().commit();
		entitymanager.close();
		emfactory.close();
	}
}
</pre>
<p>After compiling and executing the above program, you will get notifications on the console panel of Eclipse IDE. For output, check MySQL workbench. In this example, two tables are created.</p>
<p>Pass the following query in MySQL interface and the result of <b>Department</b> table will be displayed as follows:</p>    
<pre class="prettyprint notranslate">
Select * from department
</pre>
<table class="table table-bordered">
<tr>
<th>ID</th>
<th>Name</th>
</tr>
<tr>
<td>101</td>
<td>Development</td>
</tr>
</table>
<p>Pass the following query in MySQL interface and the result of <b>Employee</b> table will be displayed as follows.</p> 
<pre class="prettyprint notranslate">
Select * from employee
</pre>    
<table class="table table-bordered">
<tr>
<th>Eid</th>
<th>Deg</th>
<th>Ename</th>
<th>Salary</th>
<th>Department_Id</th>
</tr>
<tr>
<td>102</td>
<td>Technical Writer</td>
<td>Satish</td>
<td>45000</td>
<td>101</td>
</tr>
<tr>
<td>103</td>
<td>Technical Writer</td>
<td>Krishna</td>
<td>45000</td>
<td>101</td>
</tr>
<tr>
<td>104</td>
<td>Technical Writer</td>
<td>Masthanwali</td>
<td>50000</td>
<td>101</td>
</tr>
</table>
<p>In the above table Deparment_Id is the foreign key (reference field) from the Department table.</p>
<h2>@OneToMany Relation</h2>
<p>In this relationship, each row of one entity is referenced to many child records in other entity. The important thing is that child records cannot have multiple parents. In a one-to-many relationship between Table A and Table B, each row in Table A can be linked to one or multiple rows in Table B.</p>
<p>Let us consider the above example. Suppose Employee and Department tables in the above example are connected in a reverse unidirectional manner, then the relation becomes One-To-Many relation. Create a JPA project in eclipse IDE named <b>JPA_Eclipselink_OTM</b>. All the modules of this project are discussed below.</p>
<h3>Creating Entities</h3>
<p>Follow the above given diagram for creating entities. Create a package named <b>‘com.tutorialspoin.eclipselink.entity’</b> under <b>‘src’</b> package. Create a class named <b>Department.java</b> under given package. The class Department entity is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.entity;

import java.util.List;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.OneToMany;

@Entity
public class Department 
{
    @Id 
    @GeneratedValue( strategy=GenerationType.AUTO )
    private int id;
    private String name;
    
    @OneToMany( targetEntity=Employee.class )
    private List employeelist;

    public int getId() 
    {
    	return id;
    }
    
    public void setId(int id) 
    {
    	this.id = id;
    }
    
    public String getName( )
    {
    	return name;
    }
    
    public void setName( String deptName )
    {
    	this.name = deptName;
    }

    public List getEmployeelist() 
    {
	return employeelist;
    }

    public void setEmployeelist(List employeelist) 
    {
	this.employeelist = employeelist;
    }
}
</pre>
<p>Create the second entity in this relation -Employee entity class, named <b>Employee.java</b> under <b>‘com.tutorialspoint.eclipselink.entity’</b> package. The Employee entity class is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.entity;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;

@Entity
public class Employee 
{
	@Id
	@GeneratedValue( strategy= GenerationType.AUTO ) 	
	private int eid;
	private String ename;
	private double salary;
	private String deg;
		
	public Employee(int eid, 
			String ename, double salary, String deg) 
	{
		super( );
		this.eid = eid;
		this.ename = ename;
		this.salary = salary;
		this.deg = deg;
	}
	
	public Employee( ) 
	{
		super();
	}
	
	public int getEid( ) 
	{
		return eid;
	}
	public void setEid(int eid)  
	{
		this.eid = eid;
	}
	
	public String getEname( ) 
	{
		return ename;
	}
	public void setEname(String ename) 
	{
		this.ename = ename;
	}
	
	public double getSalary( ) 
	{
		return salary;
	}
	public void setSalary(double salary) 
	{
		this.salary = salary;
	}
	
	public String getDeg( ) 
	{
		return deg;
	}
	public void setDeg(String deg) 
	{
		this.deg = deg;
	}	
}
</pre>    
<h3>Persistence.xml</h3>
<p>The persistence.xml file is as follows:</p>
<pre class="prettyprint notranslate">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;persistence version="2.0" 
             xmlns="http://java.sun.com/xml/ns/persistence" 
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
             xsi:schemaLocation="http://java.sun.com/xml/ns/persistence 
             http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"&gt;
	&lt;persistence-unit name="Eclipselink_JPA" 
                        transaction-type="RESOURCE_LOCAL"&gt;
	&lt;class&gt;com.tutorialspoint.eclipselink.entity.Employee&lt;/class&gt;
	&lt;class&gt;com.tutorialspoint.eclipselink.entity.Department&lt;/class&gt;
		&lt;properties&gt;
			&lt;property name="javax.persistence.jdbc.url" 
			          value="jdbc:mysql://localhost:3306/jpadb"/&gt;
			&lt;property name="javax.persistence.jdbc.user" value="root"/&gt;
			&lt;property name="javax.persistence.jdbc.password" 
                            value="root"/&gt;
			&lt;property name="javax.persistence.jdbc.driver" 
			          value="com.mysql.jdbc.Driver"/&gt;
			&lt;property name="eclipselink.logging.level" value="FINE"/&gt;
			&lt;property name="eclipselink.ddl-generation" 
			          value="create-tables"/&gt;
		&lt;/properties&gt;
	&lt;/persistence-unit&gt;
&lt;/persistence&gt;
</pre>
<h3>Service Classes</h3>  
<p>This module contains the service classes, which implements the relational part using the attribute initialization. Create a package under <b>‘src’</b> package named <b>‘com.tutorialspoint.eclipselink.service’</b>. The DAO class named <b>OneToMany.java</b> is created under given package. The DAO class is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspointeclipselink.service;

import java.util.List;
import java.util.ArrayList;
import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import com.tutorialspoint.eclipselink.entity.Department;
import com.tutorialspoint.eclipselink.entity.Employee;

public class OneToMany 
{
	public static void main(String[] args) 
	{
		EntityManagerFactory emfactory = Persistence.
				createEntityManagerFactory( "Eclipselink_JPA" );
		EntityManager entitymanager = emfactory.
				createEntityManager( );
		entitymanager.getTransaction( ).begin( );
		
		//Create Employee1 Entity
		Employee employee1 = new Employee();
		employee1.setEname("Satish");
		employee1.setSalary(45000.0);
		employee1.setDeg("Technical Writer");
								
		//Create Employee2 Entity
		Employee employee2 = new Employee();
		employee2.setEname("Krishna");
		employee2.setSalary(45000.0);
		employee2.setDeg("Technical Writer");
								
		//Create Employee3 Entity
		Employee employee3 = new Employee();
		employee3.setEname("Masthanvali");
		employee3.setSalary(50000.0);
		employee3.setDeg("Technical Writer");
		
		//Store Employee
		entitymanager.persist(employee1);
		entitymanager.persist(employee2);
		entitymanager.persist(employee3);
		
		//Create Employeelist
		List&lt;Employee&gt; emplist = new ArrayList();
		emplist.add(employee1);
		emplist.add(employee2);
		emplist.add(employee3);
		
		//Create Department Entity
		Department department= new Department();
		department.setName("Development");
		department.setEmployeelist(emplist);
				
		//Store Department
		entitymanager.persist(department);
		
		entitymanager.getTransaction().commit();
		entitymanager.close();
		emfactory.close();
	}
}
</pre>
<p>After compilation and execution of the above program you will get notifications in the console panel of Eclipse IDE. For output check MySQL workbench as follows.</p>
<p>In this project three tables are created. Pass the following query in MySQL interface and the result of department_employee table will be displayed as follows:</p>
<pre class="prettyprint notranslate">
Select * from department_Id;
</pre>
<table class="table table-bordered">
<tr>
<th>Department_ID</th>
<th>Employee_Eid</th>
</tr>
<tr>
<td>254</td>
<td>251</td>
</tr>
<tr>
<td>254</td>
<td>252</td>
</tr>
<tr>
<td>254</td>
<td>253</td>
</tr>
</table>
<p>In the above table, <b>deparment_id</b> and <b>employee_id</b> are the foreign keys (reference fields) from department and employee tables.</p>
<p>Pass the following query in MySQL interface and the result of department table will be displayed in a tabular format as follows.</p>
<pre class="prettyprint notranslate">
Select * from department;
</pre>
<table class="table table-bordered">
<tr>
<th>ID</th>
<th>Name</th>
</tr>
<tr>
<td>254</td>
<td>Development</td>
</tr>
</table>
<p>Pass the following query in MySQL interface and the result of employee table will be displayed as follows:</p>
<pre class="prettyprint notranslate">
Select * from employee;
</pre>    
<table class="table table-bordered">
<tr>
<th>Eid</th>
<th>Deg</th>
<th>Ename</th>
<th>Salary</th>
</tr>
<tr>
<td>251</td>
<td>Technical Writer</td>
<td>Satish</td>
<td>45000</td>
</tr>
<tr>
<td>252</td>
<td>Technical Writer</td>
<td>Krishna</td>
<td>45000</td>
</tr>
<tr>
<td>253</td>
<td>Technical Writer</td>
<td>Masthanwali</td>
<td>50000</td>
</tr>
</table>
<h2>@OneToOne Relation</h2>
<p>In One-To-One relationship, one item can be linked to only one other item. It means each row of one entity is referred to one and only one row of another entity.</p>
<p>Let us consider the above example. <b>Employee</b> and <b>Department</b> in a reverse unidirectional manner, the relation is One-To-One relation. It means each employee belongs to only one department. Create a JPA project in eclipse IDE named <b>JPA_Eclipselink_OTO</b>. All the modules of this project are discussed below.</p>
<h3>Creating Entities</h3>
<p>Follow the above given diagram for creating entities. Create a package named <b>‘com.tutorialspoin.eclipselink.entity’</b> under <b>‘src’</b> package. Create a class named <b>Department.java</b> under given package. The class Department entity is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.entity;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;

@Entity
public class Department 
{
    @Id 
    @GeneratedValue( strategy=GenerationType.AUTO )
    private int id;
    private String name;
   
    public int getId() 
    {
    	return id;
    }
    
    public void setId(int id) 
    {
    	this.id = id;
    }
    
    public String getName( )
    {
    	return name;
    }
    
    public void setName( String deptName )
    {
    	this.name = deptName;
    }
}
</pre>
<p>Create the second entity in this relation -Employee entity class, named <b>Employee.java</b> under <b>‘com.tutorialspoint.eclipselink.entity’</b> package. The Employee entity class is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.entity;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.OneToOne;

@Entity
public class Employee 
{
	@Id
	@GeneratedValue( strategy= GenerationType.AUTO ) 	
	private int eid;
	private String ename;
	private double salary;
	private String deg;
	
	@OneToOne
	private Department department;
		
	public Employee(int eid, 
			String ename, double salary, String deg) 
	{
		super( );
		this.eid = eid;
		this.ename = ename;
		this.salary = salary;
		this.deg = deg;
	}
	
	public Employee( ) 
	{
		super();
	}
	
	public int getEid( ) 
	{
		return eid;
	}
	public void setEid(int eid)  
	{
		this.eid = eid;
	}
	
	public String getEname( ) 
	{
		return ename;
	}
	public void setEname(String ename) 
	{
		this.ename = ename;
	}
	
	public double getSalary( ) 
	{
		return salary;
	}
	public void setSalary(double salary) 
	{
		this.salary = salary;
	}
	
	public String getDeg( ) 
	{
		return deg;
	}
	public void setDeg(String deg) 
	{
		this.deg = deg;
	}

	public Department getDepartment() 
	{
		return department;
	}

	public void setDepartment(Department department) 
	{
		this.department = department;
	}	
}
</pre>
<h3>Persistence.xml</h3>
<p>Persistence.xml file as follows:</p>
<pre class="prettyprint notranslate">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;persistence version="2.0" 
             xmlns="http://java.sun.com/xml/ns/persistence" 
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
             xsi:schemaLocation="http://java.sun.com/xml/ns/persistence 
             http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"&gt;
	&lt;persistence-unit name="Eclipselink_JPA" 
                        transaction-type="RESOURCE_LOCAL"&gt;
	&lt;class&gt;com.tutorialspoint.eclipselink.entity.Employee&lt;/class&gt;
	&lt;class&gt;com.tutorialspoint.eclipselink.entity.Department&lt;/class&gt;
		&lt;properties&gt;
			&lt;property name="javax.persistence.jdbc.url" 
			          value="jdbc:mysql://localhost:3306/jpadb"/&gt;
			&lt;property name="javax.persistence.jdbc.user" value="root"/&gt;
			&lt;property name="javax.persistence.jdbc.password" 
                            value="root"/&gt;
			&lt;property name="javax.persistence.jdbc.driver" 
			          value="com.mysql.jdbc.Driver"/&gt;
			&lt;property name="eclipselink.logging.level" value="FINE"/&gt;
			&lt;property name="eclipselink.ddl-generation" 
			          value="create-tables"/&gt;
		&lt;/properties&gt;
	&lt;/persistence-unit&gt;
&lt;/persistence&gt;
</pre>
<h3>Service Classes</h3>
<p>Create a package under <b>‘src’</b> package named <b>‘com.tutorialspoint.eclipselink.service’</b>. The DAO class named <b>OneToOne.java</b> is created under the given package. The DAO class is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspointeclipselink.service;

import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import com.tutorialspoint.eclipselink.entity.Department;
import com.tutorialspoint.eclipselink.entity.Employee;

public class OneToOne 
{
	public static void main(String[] args) 
	{
		EntityManagerFactory emfactory = Persistence.
				createEntityManagerFactory( "Eclipselink_JPA" );
		EntityManager entitymanager = emfactory.
				createEntityManager( );
		entitymanager.getTransaction( ).begin( );
		
		//Create Department Entity
		Department department = new Department();
		department.setName("Development");
		
		//Store Department
		entitymanager.persist(department);
		
		//Create Employee Entity
		Employee employee = new Employee();
		employee.setEname("Satish");
		employee.setSalary(45000.0);
		employee.setDeg("Technical Writer");
		employee.setDepartment(department);
		
		//Store Employee
		entitymanager.persist(employee);
		
		entitymanager.getTransaction().commit();
		entitymanager.close();
		emfactory.close();
	}
}
</pre>
<p>After compilation and execution of the above program you will get notifications in the console panel of Eclipse IDE. For output, check MySQL workbench as follows.</p>
<p>In the above example, two tables are created. Pass the following query in MySQL interface and the result of department table will be displayed as follows:</p>    
<pre class="prettyprint notranslate">
Select * from department
</pre>
<table class="table table-bordered">
<tr>
<th>ID</th>
<th>Name</th>
</tr>
<tr>
<td>301</td>
<td>Development</td>
</tr>
</table>
<p>Pass the following query in MySQL interface and the result of <b>employee</b> table will be displayed as follows:</p>
<pre class="prettyprint notranslate">
Select * from employee
</pre>
<table class="table table-bordered">
<tr>
<th>Eid</th>
<th>Deg</th>
<th>Ename</th>
<th>Salary</th>
<th>Department_id</th>
</tr>
<tr>
<td>302</td>
<td>Technical Writer</td>
<td>Satish</td>
<td>45000</td>
<td>301</td>
</tr>
</table>
<h2>@ManyToMany Relation</h2>
<p>Many-To-Many relationship is where one or more rows from one entity are associated with more than one row in other entity.</p>
<p>Let us consider an example of a relation between two entities: <b>Class</b> and <b>Teacher</b>. In bidirectional manner, both Class and Teacher have Many-To-One relation. That means each record of Class is referred by Teacher set (teacher ids), which should be primary keys in the Teacher table and stored in the Teacher_Class table and vice versa. Here, the Teachers_Class table contains both the foreign key fields. Create a JPA project in eclipse IDE named <b>JPA_Eclipselink_MTM</b>. All the modules of this project are discussed below.</p>
<img src="images/many_to_many_relation.png" alt="@ManyToOne Relation" />
<h3>Creating Entities</h3>
<p>Create entities by following the schema shown in the diagram above. Create a package named <b>‘com.tutorialspoin.eclipselink.entity’</b> under <b>‘src’</b> package. Create a class named <b>Clas.java</b> under given package. The class Department entity is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.entity;

import java.util.Set;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.ManyToMany;

@Entity
public class Clas 
{
	@Id
	@GeneratedValue( strategy = GenerationType.AUTO )
	private int cid;
	private String cname;
	
	@ManyToMany(targetEntity=Teacher.class)
	private Set teacherSet;
	
	public Clas() 
	{
		super();
	}
	public Clas(int cid, 
			String cname, Set teacherSet) 
	{
		super();
		this.cid = cid;
		this.cname = cname;
		this.teacherSet = teacherSet;
	}
	public int getCid() 
	{
		return cid;
	}
	public void setCid(int cid) 
	{
		this.cid = cid;
	}
	public String getCname() 
	{
		return cname;
	}
	public void setCname(String cname) 
	{
		this.cname = cname;
	}
	public Set getTeacherSet() 
	{
		return teacherSet;
	}
	public void setTeacherSet(Set teacherSet) 
	{
		this.teacherSet = teacherSet;
	}	  
}
</pre>
<p>Create the second entity in this relation -Employee entity class, named <b>Teacher.java</b> under <b>‘com.tutorialspoint.eclipselink.entity’</b> package. The Employee entity class is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.entity;

import java.util.Set;
import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;
import javax.persistence.ManyToMany;

@Entity
public class Teacher 
{
	@Id
	@GeneratedValue( strategy = GenerationType.AUTO )
	private int tid;
	private String tname;
	private String subject;
	
	@ManyToMany(targetEntity=Clas.class)
	private Set clasSet;
	
	public Teacher() 
	{
		super();
	}
	public Teacher(int tid, String tname, String subject, 
			Set clasSet) 
	{
		super();
		this.tid = tid;
		this.tname = tname;
		this.subject = subject;
		this.clasSet = clasSet;
	}
	public int getTid() 
	{
		return tid;
	}
	public void setTid(int tid) 
	{
		this.tid = tid;
	}
	public String getTname() 
	{
		return tname;
	}
	public void setTname(String tname) 
	{
		this.tname = tname;
	}
	public String getSubject() 
	{
		return subject;
	}
	public void setSubject(String subject) 
	{
		this.subject = subject;
	}
	public Set getClasSet() 
	{
		return clasSet;
	}
	public void setClasSet(Set clasSet) 
	{
		this.clasSet = clasSet;
	}
}
</pre>
<h3>Persistence.xml</h3>
<p>Persistence.xml file  as follows:</p>
<pre class="prettyprint notranslate">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;persistence version="2.0" 
             xmlns="http://java.sun.com/xml/ns/persistence" 
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
             xsi:schemaLocation="http://java.sun.com/xml/ns/persistence 
             http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"&gt;
	&lt;persistence-unit name="Eclipselink_JPA" 
                        transaction-type="RESOURCE_LOCAL"&gt;
	&lt;class&gt;com.tutorialspoint.eclipselink.entity.Employee&lt;/class&gt;
	&lt;class&gt;com.tutorialspoint.eclipselink.entity.Department&lt;/class&gt;
		&lt;properties&gt;
			&lt;property name="javax.persistence.jdbc.url" 
			          value="jdbc:mysql://localhost:3306/jpadb"/&gt;
			&lt;property name="javax.persistence.jdbc.user" value="root"/&gt;
			&lt;property name="javax.persistence.jdbc.password" 
                            value="root"/&gt;
			&lt;property name="javax.persistence.jdbc.driver" 
			          value="com.mysql.jdbc.Driver"/&gt;
			&lt;property name="eclipselink.logging.level" value="FINE"/&gt;
			&lt;property name="eclipselink.ddl-generation" 
			          value="create-tables"/&gt;
		&lt;/properties&gt;
	&lt;/persistence-unit&gt;
&lt;/persistence>
</pre>
<h3>Service Classes</h3>
<p>Create a package under <b>‘src’</b> package named <b>‘com.tutorialspoint.eclipselink.service’</b>. The DAO class named <b>ManyToMany.java</b> is created under given package. The DAO class is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.service;

import java.util.HashSet;
import java.util.Set;
import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import com.tutorialspoint.eclipselink.entity.Clas;
import com.tutorialspoint.eclipselink.entity.Teacher;

public class ManyToMany 
{
	public static void main(String[] args) 
	{
		EntityManagerFactory emfactory = Persistence.
				createEntityManagerFactory( "Eclipselink_JPA" );
		EntityManager entitymanager = emfactory.
				createEntityManager( );
		entitymanager.getTransaction( ).begin( );
		
		//Create Clas Entity
		Clas clas1=new Clas(0,"1st",null);
		Clas clas2=new Clas(0,"2nd",null);
		Clas clas3=new Clas(0,"3rd",null);
		
		//Store Clas
		entitymanager.persist(clas1);
		entitymanager.persist(clas2);
		entitymanager.persist(clas3);
		
		//Create Clas Set1
		Set&lt;Clas&gt; classSet1 = new HashSet();
		classSet1.add(clas1);
		classSet1.add(clas2);
		classSet1.add(clas3);
		
		//Create Clas Set2
		Set&lt;Clas&gt; classSet2 = new HashSet();
		classSet2.add(clas3);
		classSet2.add(clas1);
		classSet2.add(clas2);
				
		//Create Clas Set3
		Set&lt;Clas&gt; classSet3 = new HashSet();
		classSet3.add(clas2);
		classSet3.add(clas3);
		classSet3.add(clas1);
		
		//Create Teacher Entity
		Teacher teacher1 = new Teacher(0,
				"Satish","Java",classSet1);
		Teacher teacher2 = new Teacher(0,
				"Krishna","Adv Java",classSet2);
		Teacher teacher3 = new Teacher(0,
				"Masthanvali","DB2",classSet3);
		
		//Store Teacher
		entitymanager.persist(teacher1);
		entitymanager.persist(teacher2);
		entitymanager.persist(teacher3);
		
		entitymanager.getTransaction( ).commit( );
		entitymanager.close( );
		emfactory.close( );
	}
}
</pre>
<p>In this example project, three tables are created. Pass the following query in MySQL interface and the result of teacher_clas table will be displayed as follows:</p>
<pre class="prettyprint notranslate">
Select * form teacher_clas
</pre>
<table class="table table-bordered">
<tr>
<th>Teacher_tid</th>
<th>Classet_cid</th>
</tr>
<tr>
<td>354</td>
<td>351</td>
</tr>
<tr>
<td>355</td>
<td>351</td>
</tr>
<tr>
<td>356</td>
<td>351</td>
</tr>
<tr>
<td>354</td>
<td>352</td>
</tr>
<tr>
<td>355</td>
<td>352</td>
</tr>
<tr>
<td>356</td>
<td>352</td>
</tr>
<tr>
<td>354</td>
<td>353</td>
</tr>
<tr>
<td>355</td>
<td>353</td>
</tr>
<tr>
<td>356</td>
<td>353</td>
</tr>
</table>
<p>In the above table <b>teacher_tid</b> is the foreign key from teacher table, and <b>classet_cid</b> is the foreign key from class table. Therefore different teachers are allotted to different class.</p>
<p>Pass the following query in MySQL interface and the result of teacher table will be displayed as follows:</p>
<pre class="prettyprint notranslate">
Select * from teacher
</pre>
<table class="table table-bordered">
<tr>
<th>Tid</th>
<th>Subject</th>
<th>Tname</th>
</tr>
<tr>
<td>354</td>
<td>Java</td>
<td>Satish</td>
</tr>
<tr>
<td>355</td>
<td>Adv Java</td>
<td>Krishna</td>
</tr>
<tr>
<td>356</td>
<td>DB2</td>
<td>Masthanvali</td>
</tr>
</table>
<p>Pass the following query in MySQL interface and the result of <b>clas</b> table will be displayed as follows:</p>
<pre class="prettyprint notranslate">
Select * from clas
</pre>
<table class="table table-bordered">
<tr>
<th>Cid</th>
<th>Cname</th>
</tr>
<tr>
<td>351</td>
<td>1st</td>
</tr>
<tr>
<td>352</td>
<td>2nd</td>
</tr>
<tr>
<td>353</td>
<td>3rd</td>
</tr>
</table>
<h1>JPA - Criteria API</h1>
<p>Criteria is a predefined API that is used to define queries for entities. It is an alternative way of defining a JPQL query. These queries are type-safe, portable, and easy to modify by changing the syntax. Similar to JPQL, it follows an abstract schema (easy to edit schema) and embedded objects. The metadata API is mingled with criteria API to model persistent entity for criteria queries. </p>
<p>The major advantage of Criteria API is that errors can be detected earlier during the compile time. String-based JPQL queries and JPA criteria based queries are same in performance and efficiency.</p>
<h2>History of criteria API</h2>
<p>The criteria is included into all versions of JPA therefore each step of criteria is notified in the specifications of JPA.</p>
<ul class="list">
<li>In JPA 2.0, the criteria query API, standardization of queries are developed.</li>
<li>In JPA 2.1, Criteria update and delete (bulk update and delete) are included.</li>
</ul>
<h2>Criteria Query Structure</h2>
<p>The Criteria and the JPQL are closely related and are allowed to design using similar operators in their queries. It follows <b>javax.persistence.criteria</b> package to design a query. The query structure means the syntax criteria query.</p>
<p>The following simple criteria query returns all instances of the entity class in the data source.</p>
<pre class="prettyprint notranslate">
EntityManager em = ...;
CriteriaBuilder cb = em.getCriteriaBuilder();
CriteriaQuery&lt;Entity class&gt; cq = cb.createQuery(Entity.class);
Root&lt;Entity&gt; from = cq.from(Entity.class);
cq.select(Entity);
TypedQuery&lt;Entity&gt; q = em.createQuery(cq);
List&lt;Entity&gt; allitems = q.getResultList();
</pre>
<p>The query demonstrates the basic steps to create a criteria.</p>
<ul class="list">
<li><p><b>EntityManager</b> instance is used to create a CriteriaBuilder object.</p></li>    
<li><p><b>CriteriaQuery</b> instance is used to create a query object. This query object’s attributes will be modified with the details of the query.</p></li>
<li><p><b>CriteriaQuery.form</b> method is called to set the query root.</p></li>
<li><p><b>CriteriaQuery.select</b> is called to set the result list type.</p></li>
<li><p><b>TypedQuery&lt;T&gt;</b> instance is used to prepare a query for execution and specifying the type of the query result.</p></li>
<li><p><b>getResultList</b> method on the TypedQuery&lt;T&gt; object to execute a query. This query returns a collection of entities, the result is stored in a List.</p></li>
</ul>
<h2>Example of criteria API</h2>
<p>Let us consider the example of employee database. Let us assume the jpadb.employee table contains following records:</p>
<pre class="prettyprint notranslate">
Eid	 Ename          Salary	Deg
401	 Gopal	        40000	Technical Manager
402	 Manisha	    40000	Proof reader
403	 Masthanvali    35000	Technical Writer
404  Satish	        30000	Technical writer
405	 Krishna	    30000	Technical Writer
406	 Kiran	        35000	Proof reader
</pre>
<p>Create a JPA Project in the eclipse IDE named <b>JPA_Eclipselink_Criteria</b>. All the modules of this project are discussed below:</p>
<h3>Creating Entities</h3>
<p>Create a package named <b>com.tutorialspoint.eclipselink.entity</b> under <b>‘src’</b>s package.</p>
<p>Create a class named <b>Employee.java</b> under given package. The class Employee entity is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.entity;

import javax.persistence.Entity;
import javax.persistence.GeneratedValue;
import javax.persistence.GenerationType;
import javax.persistence.Id;

@Entity
public class Employee 
{
	@Id
	@GeneratedValue(strategy= GenerationType.AUTO) 	
	private int eid;
	private String ename;
	private double salary;
	private String deg;
	public Employee(int eid, String ename, double salary, String deg) 
	{
		super( );
		this.eid = eid;
		this.ename = ename;
		this.salary = salary;
		this.deg = deg;
	}
	
	public Employee( ) 
	{
		super();
	}
	
	public int getEid( ) 
	{
		return eid;
	}
	public void setEid(int eid)  
	{
		this.eid = eid;
	}
	
	public String getEname( ) 
	{
		return ename;
	}
	public void setEname(String ename) 
	{
		this.ename = ename;
	}
	
	public double getSalary( ) 
	{
		return salary;
	}
	public void setSalary(double salary) 
	{
		this.salary = salary;
	}
	
	public String getDeg( ) 
	{
		return deg;
	}
	public void setDeg(String deg) 
	{
		this.deg = deg;
	}
	@Override
	public String toString() {
		return "Employee [eid=" + eid + ", ename=" + ename + ", salary="
				+ salary + ", deg=" + deg + "]";
	}
}
</pre>
<h3>Persistence.xml</h3>
<p>Persistence.xml file is as follows:</p>
<pre class="prettyprint notranslate">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;persistence version="2.0" xmlns="http://java.sun.com/xml/ns/persistence" 
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
             xsi:schemaLocation="http://java.sun.com/xml/ns/persistence 
             http://java.sun.com/xml/ns/persistence/persistence_2_0.xsd"&gt;
	&lt;persistence-unit name="Eclipselink_JPA" 
                        transaction-type="RESOURCE_LOCAL"&gt;
	&lt;class&gt;com.tutorialspoint.eclipselink.entity.Employee&lt;/class&gt;
		&lt;properties&gt;
			&lt;property name="javax.persistence.jdbc.url" 
			          value="jdbc:mysql://localhost:3306/jpadb"/&gt;
			&lt;property name="javax.persistence.jdbc.user" value="root"/&gt;
			&lt;property name="javax.persistence.jdbc.password" 
			          value="root"/&gt;
			&lt;property name="javax.persistence.jdbc.driver" 
			          value="com.mysql.jdbc.Driver"/&gt;
			&lt;property name="eclipselink.logging.level" value="FINE"/&gt;
			&lt;property name="eclipselink.ddl-generation" 
			          value="create-tables"/&gt;
		&lt;/properties&gt;
	&lt;/persistence-unit&gt;
&lt;/persistence&gt;
</pre>
<h3>Service classes</h3>
<p>This module contains the service classes, which implements the Criteria query part using the MetaData API initialization. Create a package named <b>‘com.tutorialspoint.eclipselink.service’</b>. The class named <b>CriteriaAPI.java</b> is created under given package. The DAO class is shown as follows:</p>
<pre class="prettyprint notranslate">
package com.tutorialspoint.eclipselink.service;

import java.util.List;
import javax.persistence.EntityManager;
import javax.persistence.EntityManagerFactory;
import javax.persistence.Persistence;
import javax.persistence.TypedQuery;
import javax.persistence.criteria.CriteriaBuilder;
import javax.persistence.criteria.CriteriaQuery;
import javax.persistence.criteria.Root;
import com.tutorialspoint.eclipselink.entity.Employee;

public class CriteriaApi 
{
	public static void main(String[] args) 
	{
		EntityManagerFactory emfactory = Persistence.
				createEntityManagerFactory( "Eclipselink_JPA" );
		EntityManager entitymanager = emfactory.
				createEntityManager( );
		CriteriaBuilder criteriaBuilder = entitymanager
				.getCriteriaBuilder();
		CriteriaQuery&lt;Object&gt; criteriaQuery = criteriaBuilder
				.createQuery();
		Root&lt;Employee&gt; from = criteriaQuery.from(Employee.class);
		
		//select all records
        System.out.println(“Select all records”);
		CriteriaQuery&lt;Object&gt; select =criteriaQuery.select(from);
		TypedQuery&lt;Object&gt; typedQuery = entitymanager
				.createQuery(select);
		List&lt;Object&gt; resultlist= typedQuery.getResultList();
		
		for(Object o:resultlist)
		{
			Employee e=(Employee)o;
			System.out.println("EID : "+e.getEid()
					+" Ename : "+e.getEname());
		}
		
		//Ordering the records 
        System.out.println(“Select all records by follow ordering”);
		CriteriaQuery&lt;Object&gt; select1 = criteriaQuery.select(from);
        select1.orderBy(criteriaBuilder.asc(from.get("ename")));
        TypedQuery&lt;Object&gt; typedQuery1 = entitymanager
        		.createQuery(select);
        List&lt;Object&gt; resultlist1= typedQuery1.getResultList();
		
		for(Object o:resultlist1)
		{
			Employee e=(Employee)o;
			System.out.println("EID : "+e.getEid()
					+" Ename : "+e.getEname());
		}
		
		entitymanager.close( );
		emfactory.close( );
	}
}
</pre>
<p>After compiling and executing the above program you will get the following output in the console panel of Eclipse IDE.</p>
<pre class="prettyprint notranslate">
Select All records
EID : 401 Ename : Gopal
EID : 402 Ename : Manisha
EID : 403 Ename : Masthanvali
EID : 404 Ename : Satish
EID : 405 Ename : Krishna
EID : 406 Ename : Kiran
Select All records by follow Ordering
EID : 401 Ename : Gopal
EID : 406 Ename : Kiran
EID : 405 Ename : Krishna
EID : 402 Ename : Manisha
EID : 403 Ename : Masthanvali
EID : 404 Ename : Satish
</pre>
<hr />
<div class="pre-btn">
<a href="jpa_criteria_api.html"><i class="icon icon-arrow-circle-o-left big-font"></i> Previous Page</a>
</div>
<div class="print-btn center">
<a href="../cgi-bin/printpage.html" target="_blank"><i class="icon icon-print big-font"></i> Print</a>
</div>
<div class="pdf-btn">
<a href="pdf/jpa_quick_guide.pdf" title="JPA Quick Guide" target="_blank"><i class="icon icon-file-pdf-o big-font"></i> PDF</a>
</div>
<div class="nxt-btn">
<a href="jpa_useful_resources.html">Next Page <i class="icon icon-arrow-circle-o-right big-font"></i>&nbsp;</a>
</div>
<hr />
<!-- PRINTING ENDS HERE -->
<div class="bottomgooglead">
<div class="bottomadtag">Advertisements</div>
<script type="text/javascript"><!--
var width = 580;
var height = 400;
var format = "580x400_as";
if( window.innerWidth < 468 ){
   width = 300;
   height = 250;
   format = "300x250_as";
}
google_ad_client = "pub-7133395778201029";
google_ad_width = width;
google_ad_height = height;
google_ad_format = format;
google_ad_type = "image";
google_ad_channel ="";
//--></script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/f.txt">
</script>
</div>
</div>
</div>
<div class="row">
<div class="col-md-3" id="rightbar">
<div class="simple-ad">
<a href="javascript:void(0)" onclick="var sTop = window.screen.height/2-(218); var sLeft = window.screen.width/2-(313);window.open('https://www.facebook.com/sharer.php?u=' + 'http://www.tutorialspoint.com/jpa/jpa_quick_guide.htm','sharer','toolbar=0,status=0,width=626,height=456,top='+sTop+',left='+sLeft);return false;">
<img src="../images/facebookIcon.jpg" alt="img" />
</a>
<a  href="javascript:void(0)" onclick="var sTop = window.screen.height/2-(218); var sLeft = window.screen.width/2-(313);window.open('https://twitter.com/share?url=' + 'http://www.tutorialspoint.com/jpa/jpa_quick_guide.htm','sharer','toolbar=0,status=0,width=626,height=456,top='+sTop+',left='+sLeft);return false;">
<img src="../images/twitterIcon.jpg" alt="img" />
</a>
<a  href="javascript:void(0)" onclick="var sTop = window.screen.height/2-(218); var sLeft = window.screen.width/2-(313);window.open('https://www.linkedin.com/cws/share?url=' + 'http://www.tutorialspoint.com/jpa/jpa_quick_guide.htm&amp;title='+ document.title,'sharer','toolbar=0,status=0,width=626,height=456,top='+sTop+',left='+sLeft);return false;">
<img src="../images/linkedinIcon.jpg" alt="img" />
</a>
<a  href="javascript:void(0)" onclick="var sTop = window.screen.height/2-(218); var sLeft = window.screen.width/2-(313);window.open('https://plus.google.com/share?url=http://www.tutorialspoint.com/jpa/jpa_quick_guide.htm','sharer','toolbar=0,status=0,width=626,height=456,top='+sTop+',left='+sLeft);return false;">
<img src="../images/googlePlusIcon.jpg" alt="img" />
</a>
<a  href="javascript:void(0)" onclick="var sTop = window.screen.height/2-(218); var sLeft = window.screen.width/2-(313);window.open('https://www.stumbleupon.com/submit?url=http://www.tutorialspoint.com/jpa/jpa_quick_guide.htm&amp;title='+ document.title,'sharer','toolbar=0,status=0,width=626,height=456,top='+sTop+',left='+sLeft);return false;">
<img src="../images/StumbleUponIcon.jpg" alt="img" />
</a>
<a  href="javascript:void(0)" onclick="var sTop = window.screen.height/2-(218); var sLeft = window.screen.width/2-(313);window.open('https://reddit.com/submit?url=http://www.tutorialspoint.com/jpa/jpa_quick_guide.htm&amp;title='+ document.title,'sharer','toolbar=0,status=0,width=626,height=656,top='+sTop+',left='+sLeft);return false;">
<img src="../images/reddit.jpg" alt="img" />
</a>
</div>
<div class="rightgooglead">
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 300;
google_ad_height = 250;
google_ad_format = "300x250_as";
google_ad_type = "image";
google_ad_channel ="";
//--></script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/f.txt">
</script>
</div>
<div class="rightgooglead">
<script type="text/javascript"><!--
google_ad_client = "pub-7133395778201029";
google_ad_width = 300;
google_ad_height = 600;
google_ad_format = "300x600_as";
google_ad_type = "image";
google_ad_channel ="";
//--></script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/f.txt">
</script>
</div>
<div class="rightgooglead">
<script type="text/javascript"><!--
google_ad_client = "ca-pub-2537027957187252";
/* Right Side Ad */
google_ad_slot = "right_side_ad";
google_ad_width = 300;
google_ad_height = 250;
//-->
</script>
<script type="text/javascript"
src="../../pagead2.googlesyndication.com/pagead/f.txt">
</script>
</div>
</div>
</div>
</div>
</div>
</div>

<div class="footer-copyright">
<div class="container">
<div class="row">
<div class="col-md-1">
<a href="../index-2.html" class="logo"> <img alt="Tutorials Point" class="img-responsive" src="../scripts/img/logo-footer.png"> </a>
</div>
<div class="col-md-4 col-sm-12 col-xs-12">
   <nav id="sub-menu">
      <ul>
         <li><a href="../about/tutorials_writing.html">Write for us</a></li>
         <li><a href="../about/faq.html">FAQ's</a></li>
         <li><a href="../about/about_helping.html">Helping</a></li>
         <li><a href="../about/contact_us.html">Contact</a></li>
      </ul>
   </nav>
</div>
<div class="col-md-3 col-sm-12 col-xs-12">
<p>&copy; Copyright 2017. All Rights Reserved.</p>
</div>
<div class="col-md-4 col-sm-12 col-xs-12">
   <div class="news-group">
      <input type="text" class="form-control-foot search" name="textemail" id="textemail" autocomplete="off" placeholder="Enter email for newsletter" onfocus="if (this.value == 'Enter email for newsletter...') {this.value = '';}" onblur="if (this.value == '') {this.value = 'Enter email for newsletter...';}">
      <span class="input-group-btn"> <button class="btn btn-default btn-footer" id="btnemail" type="submit" onclick="javascript:void(0);">go</button> </span>
      <div id="newsresponse"></div>
   </div>
</div>
</div>
</div>
</div>
</div>
<!-- Libs -->
<script type="text/javascript" src="../theme/js/custom-min7b30.js?v=4"></script>
<script src="../../www.google-analytics.com/urchin.js">
</script>
<script type="text/javascript">
_uacct = "UA-232293-6";
urchinTracker();
$('.pg-icon').click(function(){
   $('.wrapLoader').show();
});
</script>
</div>
</body>

<!-- Mirrored from www.tutorialspoint.com/jpa/jpa_quick_guide.htm by HTTrack Website Copier/3.x [XR&CO'2014], Wed, 16 Aug 2017 15:18:12 GMT -->
</html>
